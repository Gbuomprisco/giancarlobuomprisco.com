<!DOCTYPE html><html lang="en"><head><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/favicon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/favicon.png" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="msapplication-TileColor" content="#000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><meta name="author" content="Giancarlo Buomprisco"/><meta property="og:title" content="Giancarlo Buomprisco"/><meta name="description" content="Giancarlo Buomprisco&#x27;s Website"/><meta property="og:description" content="Giancarlo Buomprisco&#x27;s Website"/><meta property="og:site_name" content="giancarlobuomprisco.com"/><meta property="twitter:title" content="giancarlobuomprisco.com"/><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:creator" content="@gc_psk"/><title>Architecting the Store in NGRX</title><meta property="twitter:title" content="Architecting the Store in NGRX"/><meta property="og:description"/><meta property="article:published_time" content="2019-05-05T00:00:00.322Z"/><meta property="og:image" content="https://cdn-images-1.medium.com/max/1600/1*CYmnppaZkh7OcF1IRH15jQ.png"/><meta name="next-head-count" content="27"/><link rel="preload" href="/_next/static/css/6b58c83f2ab4d421.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6b58c83f2ab4d421.css" data-n-g=""/><link rel="preload" href="/_next/static/css/9855952b284ee7c0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9855952b284ee7c0.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-27593bf8d60abcde.js" defer=""></script><script src="/_next/static/chunks/framework-93dc06fa7fcdddfb.js" defer=""></script><script src="/_next/static/chunks/main-ee2aed86ad5514de.js" defer=""></script><script src="/_next/static/chunks/pages/_app-64e11a95ea9f54b9.js" defer=""></script><script src="/_next/static/chunks/501-5650b991910e93a7.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bcollection%5D/%5Bslug%5D-989c6371075060c5.js" defer=""></script><script src="/_next/static/4I4pCkiE8ZLXRHJos_ySC/_buildManifest.js" defer=""></script><script src="/_next/static/4I4pCkiE8ZLXRHJos_ySC/_ssgManifest.js" defer=""></script><script src="/_next/static/4I4pCkiE8ZLXRHJos_ySC/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400;600&display=swap">@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNTFM.woff) format('woff')}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFoWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFMWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFsWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFQWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFgWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFkWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFcWaDq8fMU.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuI6fMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div><main><div style="--from:#dd00316e;--to:#dd0031" class="collection-branding-bar_gradient__1Ie5x"></div><div class="container mx-auto px-5"><div class="flex-row flex justify-between my-8 md:my-12"><h2 class="font-normal tracking-tight md:tracking-tighter leading-tight"><a class="hover:underline" href="/"><b>GIANCARLO</b>BUOMPRISCO</a></h2><div><ul class="flex space-x-8 px-4"><li class="text-gray-700 hover:text-gray-900"><a href="/about">About Me</a></li></ul></div></div><article class="mb-32"><h1 class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter md:leading-none mb-8 text-center">Architecting the Store in NGRX</h1><div class="mb-4 flex justify-center"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:24px;height:24px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div><div class="max-w-2xl mx-auto mb-6"><div class="flex flex-row space-x-2 items-center justify-center"><div class="text-sm text-center text-gray-600"><time dateTime="2019-05-05T00:00:00.322Z">May	5, 2019</time></div><span class="text-gray-600">·</span><span class="text-gray-600 text-sm">10 min read</span></div></div><div class="mb-8 md:mb-16 sm:mx-0"><div class="w-12/12 md:w-8/12 mx-auto flex justify-center"><div class="sm:mx-0"><img src="https://cdn-images-1.medium.com/max/1600/1*CYmnppaZkh7OcF1IRH15jQ.png" alt="Cover Image for Architecting the Store in NGRX" loading="lazy" class="shadow-small object-contain w-full h-auto"/></div></div></div><div class="max-w-2xl mx-auto leading-loose"><div class="markdown-styles_markdown__1x9gM"><p>This is the second article of a series that aims to explain in detail a step-by-step approach to building an Angular application with NGRX.</p>
<p>In <a href="https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fstate-management-with-ngrx-introduction-1aae0803e988">the first article of this series</a>, I wrote a small overview of all the concepts surrounding the NGRX platform.</p>
<p>If you have never worked with NGRX, or have never done something in-depth with, I’d really recommend you read it.</p>
<h3>NGRX 8</h3>
<p>In the previous article, the concepts were explained using the current NGRX version. In order to keep the articles up to date, from now on I will introduce and explain the same concepts using the latest features released in NGRX version 8. There’s some really cool stuff out!</p>
<p>In particular, we will look at how to create:</p>
<ul>
<li>actions with <code>createAction</code></li>
<li>reducers with <code>createReducer</code></li>
<li>effects with <code>createEffect</code> (in the next article)</li>
</ul>
<h3>What is this article about?</h3>
<p>In this article instead, we will explore the process of building the entities that make up our store and will be setting up the entity adapter, the actions, and the reducers for each entity.</p>
<p>As a follow up to one of my previous articles about <a href="https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fbuilding-an-enterprise-grade-angular-project-structure-f5be32533ba3">creating a scalable folders structure</a>, we will see an example of creating store modules as service modules imported by our domain module.</p>
<p>We will build an application that retrieves live crypto prices from <a href="https://medium.com/r/?url=https%3A%2F%2Fcoincap.io">Coincap</a>** and displays them in a customizable dashboard.</p>
<p>We will call this demo application <em>Cryptofolio,</em> which I hope to publish at the end of this series.</p>
<p><em>** I explored various websites for fetching live prices and Coincap was by far the easiest and clearer provider. Kudos to the team!</em></p>
<h2>Setting up Angular and NGRX</h2>
<p>Let’s see how to set up an Angular application and NGRX.</p>
<h3>Angular CLI Workspace</h3>
<p>The first thing you may want to do is to create a new application with Angular CLI and add the routing and style parameters.</p>
<p><code>ng new &#x3C;app> --routing --style=scss</code></p>
<h3>NGRX</h3>
<p>Let’s install all the libraries needed to work with NGRX:</p>
<p><code>npm i @ngrx/store @ngrx/effects @ngrx/entity</code></p>
<p>And you’re pretty much all set!</p>
<h2>Project’s Folder Structure</h2>
<p>Let’s take a brief look at the project structure I opted for:</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*ZTWoVjCnGCJMMNUzxcdcUw.png" alt=""></p>
<ul>
<li><strong>What’s in store</strong>?
Every folder in <code>store</code> is an Angular Service Module that simply sets up the NGRX store and effects for the Dashboard Module, which is a domain module where our application’s smart components are placed.</li>
</ul>
<p>Let’s take a look at the <code>DashboardStoreModule</code> which is still very simple:</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">NgModule</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    imports<span class="token operator">:</span> <span class="token punctuation">[</span>
        StoreModule<span class="token punctuation">.</span><span class="token function">forFeature</span><span class="token punctuation">(</span><span class="token string">'dashboard'</span><span class="token punctuation">,</span> dashboardReducer<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// will import effects</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    providers<span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token comment">// will import providers</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DashboardStoreModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div>
<p>The <code>DashboardModule</code> will then import <code>DashboardStoreModule</code> and the other store modules:</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">NgModule</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    declarations<span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token comment">// components</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    imports<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// store service modules_ DashboardStoreModule,</span>
        PricesStoreModule<span class="token punctuation">,</span>
        AssetsStoreModule<span class="token punctuation">,</span>

        <span class="token comment">// other modules</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    exports<span class="token operator">:</span> <span class="token punctuation">[</span>RouterModule<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DashboardModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div>
<ul>
<li><strong>Where is DashboardModule imported?</strong>
The <code>DashboardModule</code> is a lazy-loaded module, so we do not import it from anywhere in our application, but instead, we reference it in our routing module configuration.</li>
</ul>
<p>In order to make lazy-loaded feature modules work with NGRX, we need to call the forRoot method, although with empty values, for both the <code>StoreModule</code> and the <code>EffectsModule</code>.</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">NgModule</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    declarations<span class="token operator">:</span> <span class="token punctuation">[</span>AppComponent<span class="token punctuation">]</span><span class="token punctuation">,</span>
    imports<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// other modules,</span>
        StoreModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> metaReducers <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        EffectsModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    bootstrap<span class="token operator">:</span> <span class="token punctuation">[</span>AppComponent<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div>
<h2>Store Entities</h2>
<p>In order to architect the store, we need to first analyze our data structures.</p>
<p>As I mentioned above, the application will feature a <strong>dashboard</strong> with <strong>tiles</strong>, and each widget will contain cryptocurrency price tickers. In order to retrieve to display the <strong>prices</strong>, we first need to load the <strong>assets (cryptocurrencies)</strong>.</p>
<p>We then have 4 different entities that we will use to build our fairly simple store:</p>
<ul>
<li>a dashboard that contains tiles (or widgets)</li>
<li>a list of assets (cryptocurrencies)</li>
<li>a price (for each asset subscribed)</li>
</ul>
<h3>Flat vs Nested Store</h3>
<p>We have two ways of building the store:</p>
<ul>
<li>a nested structure, by directly adding prices to the assets store</li>
<li>a flat structure, where assets and prices are separated into two separate objects and are only related based on the asset ID</li>
</ul>
<p>I personally prefer a flat structure. </p>
<p><strong>Why?</strong> I have, mistakenly, opted for nested structures in the past and I found the following issues:</p>
<ul>
<li>by adding a price directly to an asset, we’d be changing the original interface of the entity</li>
<li>deeper, nested structures are more difficult to query</li>
</ul>
<p>In this simple example, it doesn’t really affect greatly performance or complexity. However, if you plan on building a big application with a complex state, you will quickly see how the selectors and the store complexity creeping up as a result of a nested structure.</p>
<p>My advice is to keep the store as a flat structure of objects and keep the relations between them using unique values.</p>
<h2>Dashboard Store</h2>
<p>For simplicity, we will keep the dashboard fairly minimal. We only need two things from a widget:</p>
<ul>
<li>a tile ID</li>
<li>an asset ID</li>
</ul>
<p>In order to build this part of the store, we will use <code>@ngrx/entity</code> .</p>
<h3>Tile class</h3>
<p>Let’s first create a class named <code>Tile</code> that represents the model of our state:</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Tile</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">readonly</span> id <span class="token operator">=</span> <span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> assetId<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Of course, unless a tile is preloaded with an asset ID, the asset ID won’t be defined until the user decides which asset to display, which is why we mark as possibly <code>undefined</code>.</p>
<h3>Dashboard Adapter</h3>
<p>We move on and proceed to create the adapter for our state. Our state will simply be an entity state with a collection of tiles:</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">const</span> dashboardAdapter<span class="token operator">:</span> EntityAdapter<span class="token operator">&#x3C;</span>Tile<span class="token operator">></span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">createEntityAdapter</span><span class="token generic class-name"><span class="token operator">&#x3C;</span>
    Tile
<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h3>Dashboard Actions</h3>
<p>In order to create our actions, we will be using the new factory provided by NGRX 8 called <code>createAction</code> .</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">enum</span> DashboardActionTypes <span class="token punctuation">{</span>
    AddTile <span class="token operator">=</span> <span class="token string">'[Dashboard] ADD_TILE'</span><span class="token punctuation">,</span>
    RemoveTile <span class="token operator">=</span> <span class="token string">'[Dashboard] REMOVE_TILE'</span><span class="token punctuation">,</span>
    UpdateTile <span class="token operator">=</span> <span class="token string">'[Dashboard] UPDATE_TILE'</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> addTile <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span>
    DashboardActionTypes<span class="token punctuation">.</span>AddTile<span class="token punctuation">,</span> <span class="token comment">// action name</span>
    <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> payload<span class="token operator">:</span> Tile <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// action payload type</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> removeTile <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span>
    DashboardActionTypes<span class="token punctuation">.</span>RemoveTile<span class="token punctuation">,</span>
    <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> payload<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> updateTile <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span>
    DashboardActionTypes<span class="token punctuation">.</span>UpdateTile<span class="token punctuation">,</span>
    <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> payload<span class="token operator">:</span> Tile <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>To summarise the code, we have created 3 actions:</p>
<ul>
<li><code>addTile</code> whose payload is a <code>Tile</code> class</li>
<li><code>removeTile</code> which only receives a string as payload, which is the ID</li>
<li><code>updateTile</code> which also receives a <code>Tile</code> class</li>
</ul>
<p>Notice that <code>props</code> is a function that gets imported from <code>@ngrx/store</code> and gets called as a second argument.</p>
<h3>Dashboard Reducer</h3>
<p>In order to build the dashboard reducer, we will use the new factory method called <code>createReducer</code> that takes the following arguments:</p>
<ul>
<li>the first argument is the initial state, that we created using the entity adapter</li>
<li>all the following arguments are the reducer functions for each action, that we define using the function <code>on</code> also imported from <code>@ngrx/store</code> </li>
<li>we use the entity adapter methods in order to add, remove and update the dashboard’s tiles</li>
</ul>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// we create the state by adding an empty tile_</span>

<span class="token keyword">const</span> emptyTile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tile</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> initialState <span class="token operator">=</span> dashboardAdapter<span class="token punctuation">.</span><span class="token function">addOne</span><span class="token punctuation">(</span>
    emptyTile<span class="token punctuation">,</span>
    dashboardAdapter<span class="token punctuation">.</span><span class="token function">getInitialState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> dashboardReducerFn <span class="token operator">=</span> <span class="token function">createReducer</span><span class="token punctuation">(</span>
    initialState<span class="token punctuation">,</span>
    <span class="token function">on</span><span class="token punctuation">(</span>addTile<span class="token punctuation">,</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> dashboardAdapter<span class="token punctuation">.</span><span class="token function">addOne</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">on</span><span class="token punctuation">(</span>removeTile<span class="token punctuation">,</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> dashboardAdapter<span class="token punctuation">.</span><span class="token function">removeOne</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">on</span><span class="token punctuation">(</span>updateTile<span class="token punctuation">,</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> payload<span class="token operator">:</span> Tile <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> dashboardAdapter<span class="token punctuation">.</span><span class="token function">updateOne</span><span class="token punctuation">(</span>
            <span class="token punctuation">{</span> id<span class="token operator">:</span> payload<span class="token punctuation">.</span>id<span class="token punctuation">,</span> changes<span class="token operator">:</span> <span class="token punctuation">{</span> assetId<span class="token operator">:</span> payload<span class="token punctuation">.</span>assetId <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            state
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">dashboardReducer</span><span class="token punctuation">(</span>
    state <span class="token operator">=</span> initialState<span class="token punctuation">,</span>
    action<span class="token operator">:</span> Action
<span class="token punctuation">)</span><span class="token operator">:</span> EntityState<span class="token operator">&#x3C;</span>Tile<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">dashboardReducerFn</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>We import the reducer in the <code>DashboardStoreModule</code> :</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">NgModule</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    imports<span class="token operator">:</span> <span class="token punctuation">[</span>
         StoreModule<span class="token punctuation">.</span><span class="token function">forFeature</span><span class="token punctuation">(</span><span class="token string">'dashboard'</span><span class="token punctuation">,</span> dashboardReducer<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token comment">// more</span>
</code></pre></div>
<h2>Assets Store</h2>
<p>As we are going to receive the list of assets using Coincap’s API, we’re just going to replicate their interface:</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Asset</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    rank<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token builtin">symbol</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    supply<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    maxSupply<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    marketCapUsd<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    volumeUsd24Hr<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    priceUsd<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    changePercent24Hr<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    vwap24Hr<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h3>Assets Actions</h3>
<p>In order to fetch the assets, we will need to perform an HTTP request to Coincap’s API. The HTTP action will be going through the effect method we’re going to define in the next article. </p>
<p>What’s important to notice here is the way I’ve broken up the assets’ <em>actions</em>:</p>
<ul>
<li><strong>getAssetsRequestStarted:</strong>
action that gets dispatched when the request starts</li>
<li><strong>getAssetsRequestSuccess:</strong>
action that gets dispatched when the request succeeded (no error actions in this case for simplicity, but you should always create them)</li>
<li><strong>addAssets:</strong>
action that will only be used by the reducer, which is a command to add assets to the store</li>
</ul>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">enum</span> AssetsActionsTypes <span class="token punctuation">{</span>
    GetAssetsRequestStarted <span class="token operator">=</span> <span class="token string">'[Assets API] GET_ASSETS_REQUEST_STARTED'</span><span class="token punctuation">,</span>
    GetAssetsRequestSuccess <span class="token operator">=</span> <span class="token string">'[Assets API] GET_ASSETS_REQUEST_SUCCESS'</span><span class="token punctuation">,</span>
    AddAssets <span class="token operator">=</span> <span class="token string">'[Assets] ADD_ASSETS'</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> getAssetsRequestStarted <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span>
    AssetsActionsTypes<span class="token punctuation">.</span>GetAssetsRequestStarted<span class="token punctuation">,</span>
    <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> payload<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> getAssetsRequestSuccess <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span>
    AssetsActionsTypes<span class="token punctuation">.</span>GetAssetsRequestSuccess<span class="token punctuation">,</span>
    <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> payload<span class="token operator">:</span> Asset<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> addAssets <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span>
    AssetsActionsTypes<span class="token punctuation">.</span>AddAssets<span class="token punctuation">,</span>
    <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> payload<span class="token operator">:</span> Asset<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h3>Assets Reducer and Adapter</h3>
<p>The only reducer function reacting to the <em>addAssets</em> action will simply add all the assets to the store once they get fetched.</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// adapter</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> assetsAdapter<span class="token operator">:</span> EntityAdapter<span class="token operator">&#x3C;</span>Asset<span class="token operator">></span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">createEntityAdapter</span><span class="token generic class-name"><span class="token operator">&#x3C;</span>Asset<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">selectId</span><span class="token operator">:</span> <span class="token punctuation">(</span>asset<span class="token operator">:</span> Asset<span class="token punctuation">)</span> <span class="token operator">=></span> asset<span class="token punctuation">.</span>id
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// reducer</span>
<span class="token keyword">const</span> initialState <span class="token operator">=</span> assetsAdapter<span class="token punctuation">.</span><span class="token function">getInitialState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> assetsReducerFn <span class="token operator">=</span> <span class="token function">createReducer</span><span class="token punctuation">(</span>
    initialState<span class="token punctuation">,</span>
    <span class="token function">on</span><span class="token punctuation">(</span>addAssets<span class="token punctuation">,</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> assetsAdapter<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">assetsReducer</span><span class="token punctuation">(</span>
    state<span class="token operator">:</span> EntityState<span class="token operator">&#x3C;</span>Asset<span class="token operator">></span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
    action<span class="token operator">:</span> Action
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">assetsReducerFn</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h2>Prices Store</h2>
<p>The prices returned by Coincap’s API are very simple and are just objects with the key of an asset and its relative price. As such, we have a very simple store for prices.</p>
<h3>Prices Actions</h3>
<p>We will be creating 3 actions:</p>
<ul>
<li><strong>addPrice</strong>:
action for updating the store once a price is received</li>
<li><strong>createPriceSubscription</strong>:
action for creating a subscription</li>
<li><strong>closePriceSubscription</strong>:
action for closing a subscription</li>
</ul>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">enum</span> PricesActionsTypes <span class="token punctuation">{</span>
    AddPrice <span class="token operator">=</span> <span class="token string">'[Prices Store] ADD_PRICE'</span><span class="token punctuation">,</span>
    CreatePriceSubscription <span class="token operator">=</span> <span class="token string">'[Prices Stream] CREATE_PRICE_SUBSCRIPTION'</span><span class="token punctuation">,</span>
    ClosePriceSubscription <span class="token operator">=</span> <span class="token string">'[Prices Stream] CLOSE_PRICE_SUBSCRIPTION'</span><span class="token punctuation">,</span>
    PriceReceived <span class="token operator">=</span> <span class="token string">'[Prices Stream] PRICE_RECEIVED'</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> addPrice <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span>
    PricesActionsTypes<span class="token punctuation">.</span>AddPrice<span class="token punctuation">,</span>
    <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> payload<span class="token operator">:</span> Price <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> createPriceSubscription <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span>
    PricesActionsTypes<span class="token punctuation">.</span>CreatePriceSubscription<span class="token punctuation">,</span>
    <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> payload<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> closePriceSubscription <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span>
    PricesActionsTypes<span class="token punctuation">.</span>ClosePriceSubscription
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> priceReceived <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span>
    PricesActionsTypes<span class="token punctuation">.</span>PriceReceived<span class="token punctuation">,</span>
    <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> payload<span class="token operator">:</span> Price <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h3>Prices Reducer</h3>
<p>As the prices returned by Coincap’s real-time API are simply a key with the asset and its price, we really don’t need to do much with the entity framework.</p>
<p>Indeed, for each price received, we simply set the key with the asset ID in our store and its price by spreading the price objects with the new payload.</p>
<p>If it doesn’t exist, it gets created, otherwise, it gets overwritten with its newest value.</p>
<p>Imagine our state is:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">{ &#x26;quot;bitcoin&#x26;quot;: &#x26;quot;some price&#x26;quot; };</code></pre></div>
<p>And our payload from the WebSocket’s stream is:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">{ &#x26;quot;ethereum&#x26;quot;: &#x26;quot;another price&#x26;quot; }</code></pre></div>
<p>This will simply become:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">{
    &#x26;quot;bitcoin&#x26;quot;: &#x26;quot;some price&#x26;quot;,
    &#x26;quot;ethereum&#x26;quot;: &#x26;quot;another price&#x26;quot;
};</code></pre></div>
<p>And here is the code with one simple action:</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> initialState<span class="token operator">:</span> PriceState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> pricesReducerFn <span class="token operator">=</span> <span class="token function">createReducer</span><span class="token punctuation">(</span>
    initialState<span class="token punctuation">,</span>
    <span class="token function">on</span><span class="token punctuation">(</span>addPrice<span class="token punctuation">,</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token operator">...</span>payload <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">pricesReducer</span><span class="token punctuation">(</span>
    state <span class="token operator">=</span> initialState<span class="token punctuation">,</span>
    action<span class="token operator">:</span> Action
<span class="token punctuation">)</span><span class="token operator">:</span> PriceState <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">pricesReducerFn</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h2>An overview of the Store</h2>
<p>Let’s take a look at the store with some data:</p>
<p><img src="https://cdn-images-1.medium.com/max/2400/1*3U_DkFj1rvw_cCxWyAph4g.png" alt=""></p>
<p>Type caption for image (optional)</p>
<ul>
<li>We have fetched 5 assets</li>
<li>We have one, empty tile</li>
<li>We have no prices, as the tile has not been subscribed to an asset</li>
</ul>
<h2>Takeaways</h2>
<ul>
<li>Lay out your application entities and analyze how they relate between each other in order to have a clear understanding of what the store’s structure could look like</li>
<li>Use NGRX Entity! It’s a great tool to reduce the boilerplate of your reducers</li>
<li>Separate your UI modules from the store using Store Service Modules</li>
<li>Prefer a flat structure over a nested one</li>
<li>Keep actions clear and granular, distinguish between commands and events</li>
</ul>
<hr>
<p>In the next article, we're going to build the effects that are responsible for fetching assets and prices from Coincap’s API.</p>
<p>Read it at the link below:
<a href="https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fbuilding-side-effects-in-ngrx-deb0d856096d">Building Side Effects in NGRX</a></p>
<hr>
<p>Hope you enjoyed the article and send me a message if you agree, disagree, or would do anything differently!</p>
</div></div></article><div class="w-full md:w-8/12 mx-auto"><script async="" data-uid="3e3126f064" src="https://thoughtful-inventor-7842.ck.page/3e3126f064/index.js"></script></div><div><hr class="border-accent-2 mt-16 mb-14"/><h3 class="text-2xl md:text-3xl text-center font-semibold my-4 md:my-12 flex flex-row space-x-4 items-center justify-center"><span>More Posts for</span> <div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:28px;height:28px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></h3><section><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 md:gap-x-12 lg:gap-x-16 gap-y-20 md:gap-y-24 mb-32"><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Benchmarking Angular 12 with Webpack 5" href="/angular/webpack-5-angular12"><img src="/assets/images/posts/benchmarking-webpack-5.webp" alt="Cover Image for Benchmarking Angular 12 with Webpack 5" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/webpack-5-angular12">Benchmarking Angular 12 with Webpack 5</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2021-05-14T00:00:00.322Z">May	14, 2021</time></div><span class="text-gray-600">·</span><span class="text-gray-600">2 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Angular 12 has been released and with it the much awaited Webpack 5 upgrade. In this post I benchmarked the bundle-size and compilation speed against the previous version</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Principles for creating libraries with Nx and Angular" href="/angular/how-to-organize-nx-modules-with-angular"><img src="/assets/images/posts/organize-nx-modules-ngrx.webp" alt="Cover Image for Principles for creating libraries with Nx and Angular" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/how-to-organize-nx-modules-with-angular">Principles for creating libraries with Nx and Angular</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2021-02-07T00:00:00.322Z">February	7, 2021</time></div><span class="text-gray-600">·</span><span class="text-gray-600">5 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Working with Nx may be confusing. This article explains how I create Nx libraries and the principles behind my motivations</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Where to put your Angular models?" href="/angular/angular-where-to-put-models"><img src="/assets/images/posts/where-put-angular-models.webp" alt="Cover Image for Where to put your Angular models?" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/angular-where-to-put-models">Where to put your Angular models?</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2020-08-03T00:00:00.322Z">August	3, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Organizing entities and models in your Angular app may be hard. This article explains where to put your entities and what mistakes to watch out for</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Using the Intersection Observer API with Angular" href="/angular/intersection-observer-with-angular"><img src="/assets/images/posts/intersection-observer.webp" alt="Cover Image for Using the Intersection Observer API with Angular" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/intersection-observer-with-angular">Using the Intersection Observer API with Angular</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2020-08-01T00:00:00.322Z">August	1, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">5 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">This article shows how to build a directive with Angular that uses the Intersection Observer API to check when an element becomes visible on the page</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Setters vs ngOnChanges: which one is better?" href="/angular/setters-vs-ng-on-changes"><img src="/assets/images/posts/setters-vs-on-changes.webp" alt="Cover Image for Setters vs ngOnChanges: which one is better?" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/setters-vs-ng-on-changes">Setters vs ngOnChanges: which one is better?</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2020-07-30T00:00:00.322Z">July	30, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Listening to Input changes can be done in different ways. But which one should you use?</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Async Rendering with a single Rx Operator" href="/angular/async-rendering-with-a-single-rx-operator"><img src="/assets/images/posts/async-rendering.webp" alt="Cover Image for Async Rendering with a single Rx Operator" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/async-rendering-with-a-single-rx-operator">Async Rendering with a single Rx Operator</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2020-07-11T00:00:00.322Z">July	11, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Increase your app rendering performance with this simple Rx operator</p></div></div></section></div></div></main></div><footer><div class="container mx-auto px-5"><hr class="border-accent-2 mt-16 mb-14"/><div class="flex-row flex justify-between my-8 md:my-12"><h2 class="font-normal tracking-tight md:tracking-tighter leading-tight"><a class="hover:underline" href="/"><b>GIANCARLO</b>BUOMPRISCO</a></h2><div><ul class="flex space-x-8 px-4"><li class="text-gray-700 hover:text-gray-900"><a href="/about">About Me</a></li></ul></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"readingTime":"10 min read","live":true,"title":"Architecting the Store in NGRX","date":"2019-05-05T00:00:00.322Z","slug":"architecting-the-store-in-ngrx","content":"\u003cp\u003eThis is the second article of a series that aims to explain in detail a step-by-step approach to building an Angular application with NGRX.\u003c/p\u003e\n\u003cp\u003eIn \u003ca href=\"https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fstate-management-with-ngrx-introduction-1aae0803e988\"\u003ethe first article of this series\u003c/a\u003e, I wrote a small overview of all the concepts surrounding the NGRX platform.\u003c/p\u003e\n\u003cp\u003eIf you have never worked with NGRX, or have never done something in-depth with, I’d really recommend you read it.\u003c/p\u003e\n\u003ch3\u003eNGRX 8\u003c/h3\u003e\n\u003cp\u003eIn the previous article, the concepts were explained using the current NGRX version. In order to keep the articles up to date, from now on I will introduce and explain the same concepts using the latest features released in NGRX version 8. There’s some really cool stuff out!\u003c/p\u003e\n\u003cp\u003eIn particular, we will look at how to create:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eactions with \u003ccode\u003ecreateAction\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003ereducers with \u003ccode\u003ecreateReducer\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eeffects with \u003ccode\u003ecreateEffect\u003c/code\u003e (in the next article)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eWhat is this article about?\u003c/h3\u003e\n\u003cp\u003eIn this article instead, we will explore the process of building the entities that make up our store and will be setting up the entity adapter, the actions, and the reducers for each entity.\u003c/p\u003e\n\u003cp\u003eAs a follow up to one of my previous articles about \u003ca href=\"https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fbuilding-an-enterprise-grade-angular-project-structure-f5be32533ba3\"\u003ecreating a scalable folders structure\u003c/a\u003e, we will see an example of creating store modules as service modules imported by our domain module.\u003c/p\u003e\n\u003cp\u003eWe will build an application that retrieves live crypto prices from \u003ca href=\"https://medium.com/r/?url=https%3A%2F%2Fcoincap.io\"\u003eCoincap\u003c/a\u003e** and displays them in a customizable dashboard.\u003c/p\u003e\n\u003cp\u003eWe will call this demo application \u003cem\u003eCryptofolio,\u003c/em\u003e which I hope to publish at the end of this series.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003e** I explored various websites for fetching live prices and Coincap was by far the easiest and clearer provider. Kudos to the team!\u003c/em\u003e\u003c/p\u003e\n\u003ch2\u003eSetting up Angular and NGRX\u003c/h2\u003e\n\u003cp\u003eLet’s see how to set up an Angular application and NGRX.\u003c/p\u003e\n\u003ch3\u003eAngular CLI Workspace\u003c/h3\u003e\n\u003cp\u003eThe first thing you may want to do is to create a new application with Angular CLI and add the routing and style parameters.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eng new \u0026#x3C;app\u003e --routing --style=scss\u003c/code\u003e\u003c/p\u003e\n\u003ch3\u003eNGRX\u003c/h3\u003e\n\u003cp\u003eLet’s install all the libraries needed to work with NGRX:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003enpm i @ngrx/store @ngrx/effects @ngrx/entity\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eAnd you’re pretty much all set!\u003c/p\u003e\n\u003ch2\u003eProject’s Folder Structure\u003c/h2\u003e\n\u003cp\u003eLet’s take a brief look at the project structure I opted for:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://cdn-images-1.medium.com/max/1600/1*ZTWoVjCnGCJMMNUzxcdcUw.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eWhat’s in store\u003c/strong\u003e?\nEvery folder in \u003ccode\u003estore\u003c/code\u003e is an Angular Service Module that simply sets up the NGRX store and effects for the Dashboard Module, which is a domain module where our application’s smart components are placed.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLet’s take a look at the \u003ccode\u003eDashboardStoreModule\u003c/code\u003e which is still very simple:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eNgModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    imports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n        StoreModule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforFeature\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'dashboard'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dashboardReducer\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e// will import effects\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    providers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n       \u003cspan class=\"token comment\"\u003e// will import providers\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eDashboardStoreModule\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003eDashboardModule\u003c/code\u003e will then import \u003ccode\u003eDashboardStoreModule\u003c/code\u003e and the other store modules:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eNgModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    declarations\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n       \u003cspan class=\"token comment\"\u003e// components\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    imports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e// store service modules_ DashboardStoreModule,\u003c/span\u003e\n        PricesStoreModule\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        AssetsStoreModule\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\n        \u003cspan class=\"token comment\"\u003e// other modules\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    exports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eRouterModule\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eDashboardModule\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eWhere is DashboardModule imported?\u003c/strong\u003e\nThe \u003ccode\u003eDashboardModule\u003c/code\u003e is a lazy-loaded module, so we do not import it from anywhere in our application, but instead, we reference it in our routing module configuration.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn order to make lazy-loaded feature modules work with NGRX, we need to call the forRoot method, although with empty values, for both the \u003ccode\u003eStoreModule\u003c/code\u003e and the \u003ccode\u003eEffectsModule\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eNgModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    declarations\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eAppComponent\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    imports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e// other modules,\u003c/span\u003e\n        StoreModule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforRoot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e metaReducers \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        EffectsModule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforRoot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    bootstrap\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eAppComponent\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eAppModule\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eStore Entities\u003c/h2\u003e\n\u003cp\u003eIn order to architect the store, we need to first analyze our data structures.\u003c/p\u003e\n\u003cp\u003eAs I mentioned above, the application will feature a \u003cstrong\u003edashboard\u003c/strong\u003e with \u003cstrong\u003etiles\u003c/strong\u003e, and each widget will contain cryptocurrency price tickers. In order to retrieve to display the \u003cstrong\u003eprices\u003c/strong\u003e, we first need to load the \u003cstrong\u003eassets (cryptocurrencies)\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eWe then have 4 different entities that we will use to build our fairly simple store:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea dashboard that contains tiles (or widgets)\u003c/li\u003e\n\u003cli\u003ea list of assets (cryptocurrencies)\u003c/li\u003e\n\u003cli\u003ea price (for each asset subscribed)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eFlat vs Nested Store\u003c/h3\u003e\n\u003cp\u003eWe have two ways of building the store:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea nested structure, by directly adding prices to the assets store\u003c/li\u003e\n\u003cli\u003ea flat structure, where assets and prices are separated into two separate objects and are only related based on the asset ID\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eI personally prefer a flat structure. \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWhy?\u003c/strong\u003e I have, mistakenly, opted for nested structures in the past and I found the following issues:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eby adding a price directly to an asset, we’d be changing the original interface of the entity\u003c/li\u003e\n\u003cli\u003edeeper, nested structures are more difficult to query\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn this simple example, it doesn’t really affect greatly performance or complexity. However, if you plan on building a big application with a complex state, you will quickly see how the selectors and the store complexity creeping up as a result of a nested structure.\u003c/p\u003e\n\u003cp\u003eMy advice is to keep the store as a flat structure of objects and keep the relations between them using unique values.\u003c/p\u003e\n\u003ch2\u003eDashboard Store\u003c/h2\u003e\n\u003cp\u003eFor simplicity, we will keep the dashboard fairly minimal. We only need two things from a widget:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea tile ID\u003c/li\u003e\n\u003cli\u003ean asset ID\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn order to build this part of the store, we will use \u003ccode\u003e@ngrx/entity\u003c/code\u003e .\u003c/p\u003e\n\u003ch3\u003eTile class\u003c/h3\u003e\n\u003cp\u003eLet’s first create a class named \u003ccode\u003eTile\u003c/code\u003e that represents the model of our state:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eTile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ereadonly\u003c/span\u003e id \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003euuid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"token function\"\u003econstructor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003epublic\u003c/span\u003e assetId\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOf course, unless a tile is preloaded with an asset ID, the asset ID won’t be defined until the user decides which asset to display, which is why we mark as possibly \u003ccode\u003eundefined\u003c/code\u003e.\u003c/p\u003e\n\u003ch3\u003eDashboard Adapter\u003c/h3\u003e\n\u003cp\u003eWe move on and proceed to create the adapter for our state. Our state will simply be an entity state with a collection of tiles:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e dashboardAdapter\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e EntityAdapter\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eTile\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003ecreateEntityAdapter\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\n    Tile\n\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eDashboard Actions\u003c/h3\u003e\n\u003cp\u003eIn order to create our actions, we will be using the new factory provided by NGRX 8 called \u003ccode\u003ecreateAction\u003c/code\u003e .\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eenum\u003c/span\u003e DashboardActionTypes \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    AddTile \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'[Dashboard] ADD_TILE'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    RemoveTile \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'[Dashboard] REMOVE_TILE'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    UpdateTile \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'[Dashboard] UPDATE_TILE'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e addTile \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateAction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    DashboardActionTypes\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eAddTile\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// action name\u003c/span\u003e\n    \u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003eprops\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Tile \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// action payload type\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e removeTile \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateAction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    DashboardActionTypes\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eRemoveTile\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003eprops\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e updateTile \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateAction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    DashboardActionTypes\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eUpdateTile\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003eprops\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Tile \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTo summarise the code, we have created 3 actions:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eaddTile\u003c/code\u003e whose payload is a \u003ccode\u003eTile\u003c/code\u003e class\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eremoveTile\u003c/code\u003e which only receives a string as payload, which is the ID\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eupdateTile\u003c/code\u003e which also receives a \u003ccode\u003eTile\u003c/code\u003e class\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNotice that \u003ccode\u003eprops\u003c/code\u003e is a function that gets imported from \u003ccode\u003e@ngrx/store\u003c/code\u003e and gets called as a second argument.\u003c/p\u003e\n\u003ch3\u003eDashboard Reducer\u003c/h3\u003e\n\u003cp\u003eIn order to build the dashboard reducer, we will use the new factory method called \u003ccode\u003ecreateReducer\u003c/code\u003e that takes the following arguments:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe first argument is the initial state, that we created using the entity adapter\u003c/li\u003e\n\u003cli\u003eall the following arguments are the reducer functions for each action, that we define using the function \u003ccode\u003eon\u003c/code\u003e also imported from \u003ccode\u003e@ngrx/store\u003c/code\u003e \u003c/li\u003e\n\u003cli\u003ewe use the entity adapter methods in order to add, remove and update the dashboard’s tiles\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token comment\"\u003e// we create the state by adding an empty tile_\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e emptyTile \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eTile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eundefined\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e initialState \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e dashboardAdapter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eaddOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    emptyTile\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    dashboardAdapter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetInitialState\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e dashboardReducerFn \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateReducer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    initialState\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eon\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eaddTile\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e dashboardAdapter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eaddOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eon\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eremoveTile\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e dashboardAdapter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eremoveOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eon\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eupdateTile\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Tile \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e dashboardAdapter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eupdateOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e changes\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e assetId\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eassetId \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            state\n        \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003edashboardReducer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    state \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e initialState\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    action\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Action\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e EntityState\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eTile\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003edashboardReducerFn\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e action\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe import the reducer in the \u003ccode\u003eDashboardStoreModule\u003c/code\u003e :\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eNgModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    imports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n         StoreModule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforFeature\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'dashboard'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dashboardReducer\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// more\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eAssets Store\u003c/h2\u003e\n\u003cp\u003eAs we are going to receive the list of assets using Coincap’s API, we’re just going to replicate their interface:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eAsset\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    rank\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token builtin\"\u003esymbol\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    supply\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    maxSupply\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enull\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    marketCapUsd\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    volumeUsd24Hr\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    priceUsd\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    changePercent24Hr\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    vwap24Hr\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eAssets Actions\u003c/h3\u003e\n\u003cp\u003eIn order to fetch the assets, we will need to perform an HTTP request to Coincap’s API. The HTTP action will be going through the effect method we’re going to define in the next article. \u003c/p\u003e\n\u003cp\u003eWhat’s important to notice here is the way I’ve broken up the assets’ \u003cem\u003eactions\u003c/em\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003egetAssetsRequestStarted:\u003c/strong\u003e\naction that gets dispatched when the request starts\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003egetAssetsRequestSuccess:\u003c/strong\u003e\naction that gets dispatched when the request succeeded (no error actions in this case for simplicity, but you should always create them)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eaddAssets:\u003c/strong\u003e\naction that will only be used by the reducer, which is a command to add assets to the store\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eenum\u003c/span\u003e AssetsActionsTypes \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    GetAssetsRequestStarted \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'[Assets API] GET_ASSETS_REQUEST_STARTED'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    GetAssetsRequestSuccess \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'[Assets API] GET_ASSETS_REQUEST_SUCCESS'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    AddAssets \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'[Assets] ADD_ASSETS'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e getAssetsRequestStarted \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateAction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    AssetsActionsTypes\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eGetAssetsRequestStarted\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003eprops\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e getAssetsRequestSuccess \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateAction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    AssetsActionsTypes\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eGetAssetsRequestSuccess\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003eprops\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Asset\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e addAssets \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateAction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    AssetsActionsTypes\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eAddAssets\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003eprops\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Asset\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eAssets Reducer and Adapter\u003c/h3\u003e\n\u003cp\u003eThe only reducer function reacting to the \u003cem\u003eaddAssets\u003c/em\u003e action will simply add all the assets to the store once they get fetched.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token comment\"\u003e// adapter\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e assetsAdapter\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e EntityAdapter\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eAsset\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003ecreateEntityAdapter\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eAsset\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function-variable function\"\u003eselectId\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003easset\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Asset\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e asset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eid\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// reducer\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e initialState \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e assetsAdapter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetInitialState\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e assetsReducerFn \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateReducer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    initialState\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eon\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eaddAssets\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e assetsAdapter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eaddAll\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eassetsReducer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    state\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e EntityState\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eAsset\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eundefined\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    action\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Action\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003eassetsReducerFn\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e action\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003ePrices Store\u003c/h2\u003e\n\u003cp\u003eThe prices returned by Coincap’s API are very simple and are just objects with the key of an asset and its relative price. As such, we have a very simple store for prices.\u003c/p\u003e\n\u003ch3\u003ePrices Actions\u003c/h3\u003e\n\u003cp\u003eWe will be creating 3 actions:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eaddPrice\u003c/strong\u003e:\naction for updating the store once a price is received\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ecreatePriceSubscription\u003c/strong\u003e:\naction for creating a subscription\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eclosePriceSubscription\u003c/strong\u003e:\naction for closing a subscription\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eenum\u003c/span\u003e PricesActionsTypes \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    AddPrice \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'[Prices Store] ADD_PRICE'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    CreatePriceSubscription \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'[Prices Stream] CREATE_PRICE_SUBSCRIPTION'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    ClosePriceSubscription \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'[Prices Stream] CLOSE_PRICE_SUBSCRIPTION'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    PriceReceived \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'[Prices Stream] PRICE_RECEIVED'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e addPrice \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateAction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    PricesActionsTypes\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eAddPrice\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003eprops\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Price \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e createPriceSubscription \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateAction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    PricesActionsTypes\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCreatePriceSubscription\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003eprops\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e closePriceSubscription \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateAction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    PricesActionsTypes\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eClosePriceSubscription\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e priceReceived \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateAction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    PricesActionsTypes\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ePriceReceived\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003eprops\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Price \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003ePrices Reducer\u003c/h3\u003e\n\u003cp\u003eAs the prices returned by Coincap’s real-time API are simply a key with the asset and its price, we really don’t need to do much with the entity framework.\u003c/p\u003e\n\u003cp\u003eIndeed, for each price received, we simply set the key with the asset ID in our store and its price by spreading the price objects with the new payload.\u003c/p\u003e\n\u003cp\u003eIf it doesn’t exist, it gets created, otherwise, it gets overwritten with its newest value.\u003c/p\u003e\n\u003cp\u003eImagine our state is:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e{ \u0026#x26;quot;bitcoin\u0026#x26;quot;: \u0026#x26;quot;some price\u0026#x26;quot; };\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd our payload from the WebSocket’s stream is:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e{ \u0026#x26;quot;ethereum\u0026#x26;quot;: \u0026#x26;quot;another price\u0026#x26;quot; }\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis will simply become:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e{\n    \u0026#x26;quot;bitcoin\u0026#x26;quot;: \u0026#x26;quot;some price\u0026#x26;quot;,\n    \u0026#x26;quot;ethereum\u0026#x26;quot;: \u0026#x26;quot;another price\u0026#x26;quot;\n};\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd here is the code with one simple action:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e initialState\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e PriceState \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e pricesReducerFn \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateReducer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    initialState\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eon\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eaddPrice\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e payload \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token operator\"\u003e...\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token operator\"\u003e...\u003c/span\u003epayload \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003epricesReducer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    state \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e initialState\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    action\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Action\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e PriceState \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003epricesReducerFn\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e action\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eAn overview of the Store\u003c/h2\u003e\n\u003cp\u003eLet’s take a look at the store with some data:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://cdn-images-1.medium.com/max/2400/1*3U_DkFj1rvw_cCxWyAph4g.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eType caption for image (optional)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWe have fetched 5 assets\u003c/li\u003e\n\u003cli\u003eWe have one, empty tile\u003c/li\u003e\n\u003cli\u003eWe have no prices, as the tile has not been subscribed to an asset\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eTakeaways\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eLay out your application entities and analyze how they relate between each other in order to have a clear understanding of what the store’s structure could look like\u003c/li\u003e\n\u003cli\u003eUse NGRX Entity! It’s a great tool to reduce the boilerplate of your reducers\u003c/li\u003e\n\u003cli\u003eSeparate your UI modules from the store using Store Service Modules\u003c/li\u003e\n\u003cli\u003ePrefer a flat structure over a nested one\u003c/li\u003e\n\u003cli\u003eKeep actions clear and granular, distinguish between commands and events\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003eIn the next article, we're going to build the effects that are responsible for fetching assets and prices from Coincap’s API.\u003c/p\u003e\n\u003cp\u003eRead it at the link below:\n\u003ca href=\"https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fbuilding-side-effects-in-ngrx-deb0d856096d\"\u003eBuilding Side Effects in NGRX\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eHope you enjoyed the article and send me a message if you agree, disagree, or would do anything differently!\u003c/p\u003e\n","ogImage":{"url":"https://cdn-images-1.medium.com/max/1600/1*CYmnppaZkh7OcF1IRH15jQ.png"},"coverImage":"https://cdn-images-1.medium.com/max/1600/1*CYmnppaZkh7OcF1IRH15jQ.png","collection":"angular"},"morePosts":[{"readingTime":"2 min read","live":true,"title":"Benchmarking Angular 12 with Webpack 5","date":"2021-05-14T00:00:00.322Z","slug":"webpack-5-angular12","coverImage":"/assets/images/posts/benchmarking-webpack-5.webp","collection":"angular","excerpt":"Angular 12 has been released and with it the much awaited Webpack 5 upgrade. In this post I benchmarked the bundle-size and compilation speed against the previous version"},{"readingTime":"5 min read","live":true,"title":"Principles for creating libraries with Nx and Angular","date":"2021-02-07T00:00:00.322Z","slug":"how-to-organize-nx-modules-with-angular","coverImage":"/assets/images/posts/organize-nx-modules-ngrx.webp","collection":"angular","excerpt":"Working with Nx may be confusing. This article explains how I create Nx libraries and the principles behind my motivations"},{"readingTime":"3 min read","live":true,"title":"Where to put your Angular models?","date":"2020-08-03T00:00:00.322Z","slug":"angular-where-to-put-models","ogImage":{"url":"/assets/images/posts/where-put-angular-models.png"},"coverImage":"/assets/images/posts/where-put-angular-models.webp","collection":"angular","excerpt":"Organizing entities and models in your Angular app may be hard. This article explains where to put your entities and what mistakes to watch out for"},{"readingTime":"5 min read","live":true,"title":"Using the Intersection Observer API with Angular","date":"2020-08-01T00:00:00.322Z","slug":"intersection-observer-with-angular","coverImage":"/assets/images/posts/intersection-observer.webp","collection":"angular","excerpt":"This article shows how to build a directive with Angular that uses the Intersection Observer API to check when an element becomes visible on the page"},{"readingTime":"3 min read","live":true,"title":"Setters vs ngOnChanges: which one is better?","date":"2020-07-30T00:00:00.322Z","slug":"setters-vs-ng-on-changes","coverImage":"/assets/images/posts/setters-vs-on-changes.webp","collection":"angular","excerpt":"Listening to Input changes can be done in different ways. But which one should you use?"},{"readingTime":"3 min read","live":true,"title":"Async Rendering with a single Rx Operator","date":"2020-07-11T00:00:00.322Z","slug":"async-rendering-with-a-single-rx-operator","coverImage":"/assets/images/posts/async-rendering.webp","collection":"angular","excerpt":"Increase your app rendering performance with this simple Rx operator"}]},"__N_SSG":true},"page":"/[collection]/[slug]","query":{"collection":"angular","slug":"architecting-the-store-in-ngrx"},"buildId":"4I4pCkiE8ZLXRHJos_ySC","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-172483071-1"></script><script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-172483071-1');
</script></body></html>