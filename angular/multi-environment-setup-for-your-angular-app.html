<!DOCTYPE html><html lang="en"><head><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/favicon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/favicon.png" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="msapplication-TileColor" content="#000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><meta name="author" content="Giancarlo Buomprisco"/><meta property="og:title" content="Giancarlo Buomprisco"/><meta name="description" content="Giancarlo Buomprisco&#x27;s Website"/><meta property="og:description" content="Giancarlo Buomprisco&#x27;s Website"/><meta property="og:site_name" content="giancarlobuomprisco.com"/><meta property="twitter:title" content="giancarlobuomprisco.com"/><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:creator" content="@gc_psk"/><title>Multi-environment setup for your Angular app</title><meta property="twitter:title" content="Multi-environment setup for your Angular app"/><meta property="article:published_time" content="2019-04-19T00:00:00.322Z"/><meta property="og:image" content="/assets/images/posts/multi-environment-angular.png"/><meta name="next-head-count" content="26"/><link rel="preload" href="/_next/static/css/5a855b84713e7055.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5a855b84713e7055.css" data-n-g=""/><link rel="preload" href="/_next/static/css/9855952b284ee7c0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9855952b284ee7c0.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-27593bf8d60abcde.js" defer=""></script><script src="/_next/static/chunks/framework-93dc06fa7fcdddfb.js" defer=""></script><script src="/_next/static/chunks/main-e47b4831833660b7.js" defer=""></script><script src="/_next/static/chunks/pages/_app-64e11a95ea9f54b9.js" defer=""></script><script src="/_next/static/chunks/501-5650b991910e93a7.js" defer=""></script><script src="/_next/static/chunks/386-a7b2d3791d396538.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bcollection%5D/%5Bslug%5D-b0f12f6bf2b31120.js" defer=""></script><script src="/_next/static/FAXXTPpbWtKysjJUThVvt/_buildManifest.js" defer=""></script><script src="/_next/static/FAXXTPpbWtKysjJUThVvt/_ssgManifest.js" defer=""></script><script src="/_next/static/FAXXTPpbWtKysjJUThVvt/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400;600&display=swap">@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNTFM.woff) format('woff')}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFoWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFMWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFsWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFQWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFgWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFkWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFcWaDq8fMU.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuI6fMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuDyYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div><main><div style="--from:#dd00316e;--to:#e23236" class="collection-branding-bar_gradient__1Ie5x"></div><div class="container mx-auto px-5"><div class="flex-row flex justify-between items-center my-8 md:my-12"><h2 class="font-normal tracking-tight md:tracking-tighter leading-tight"><a class="hover:underline" href="/"><b>GIANCARLO</b>BUOMPRISCO</a></h2><div class="justify-end lg:hidden flex"><button aria-label="Open Menu" class="navbar-burger" type="button"><span class="block relative w-7 rounded-sm bg-black h-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span></button></div><ul class="lg:space-x-8 px-4 hidden flex-col space-y-4 lg:space-y-0 lg:flex lg:flex-row nav"><li class="flex flex-row justify-between mb-6 lg:hidden"><h2 class="font-normal tracking-tight md:tracking-tighter leading-tight"><a class="hover:underline" href="/"><b>GIANCARLO</b>BUOMPRISCO</a></h2><div class="flex justify-end"><span class="rounded bg-gray-50 shadow-lg p-4">Close</span></div></li><li class="active:text-black text-lg lg:text-base text-gray-800 hover:text-gray-900 font-medium hover:underline"><a class="block" href="/articles">Articles</a></li><li class="active:text-black text-lg lg:text-base text-gray-800 hover:text-gray-900 font-medium hover:underline"><a class="block" href="/about">About</a></li><li class="active:text-black text-lg lg:text-base text-gray-800 hover:text-gray-900 font-medium hover:underline"><a class="block" href="/contact">Contact me</a></li></ul></div><article class="mb-16"><h1 class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter md:leading-none mb-8 text-center">Multi-environment setup for your Angular app</h1><div class="mb-4 flex justify-center"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img loading="lazy" style="width:18px;height:18px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div><div class="max-w-2xl mx-auto mb-6"><div class="flex flex-row space-x-2 items-center justify-center"><div class="text-sm text-center text-gray-600"><time dateTime="2019-04-19T00:00:00.322Z">April	19, 2019</time></div><span class="text-gray-600">·</span><span class="text-gray-600 text-sm">5 min read</span></div></div><div class="mb-8 md:mb-16 sm:mx-0"><div class="mx-auto w-12/12 lg:w-10/12 xl:w-8/12 justify-center"><div class="sm:mx-0"><img style="width:100%;height:auto" class="shadow-small block" src="/assets/images/posts/multi-environment-angular.png" alt="Cover Image for Multi-environment setup for your Angular app" loading="lazy"/></div></div></div><div class="mb-12 max-w-2xl mx-auto"></div><div class="max-w-2xl mx-auto leading-loose"><div class="markdown-styles_markdown__1x9gM"><p>One of the most welcome additions to our tooling as Angular developers is certainly the Angular CLI. The CLI allows us to bootstrap an Angular app and also manage it through all its lifecycle. </p>
<p>One of the best features I enjoyed using is setting up multiple environments for my projects. Most applications will probably use at the very least two environments: production and development. Most likely, larger applications will be running several environments, such as QA, RC, pre-prod, and so on.</p>
<h2>Configurations</h2>
<p>The Angular CLI bootstraps a new project with two files within the folder <code>environments</code>: <code>environments.ts</code> and <code>environments.prod.ts.</code> . </p>
<ul>
<li><em>environment.prod.ts</em> is the configuration file that the CLI injects for us when the app is built using the production configuration</li>
<li><em>environment.ts</em> is the configuration file we reference in our application, and the CLI will take care of getting the correct configuration at build time</li>
</ul>
<p>What do these files look like? They’re just a simple constant object exported as “environment”, which initially looks like this:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">// environment.ts
export const environment = {
  production: false
};

----------------------------

// environment.prod.ts
export const environment = {
  production: true
};</code></pre></div>
<blockquote>
<p>⚠️ As you may have guessed, these values are injected into the client at build time. So be aware — don’t pass sensitive values to this object.</p>
</blockquote>
<p>The CLI allows us to define multiple custom configurations which we will align with our infrastructure’s environments. So, for example, we can define two more environments — <em>dev</em> and <em>qa</em>.</p>
<p>Let’s go ahead and create two more files in the same folder which we will call <em>environment.dev.ts</em> and <em>environment.qa.ts.</em></p>
<p>In order to set up the environments correctly, we also need to let Angular know by adding these to the configuration file <em>angular.json.</em> We will do this by extending the <em>configurations</em> object:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">... // angular.json
configurations&#x26;quot;: {
    &#x26;quot;production&#x26;quot; {...} // leave as it is,

    &#x26;quot;qa&#x26;quot;: {
        &#x26;quot;fileReplacements&#x26;quot;: [
            {
                &#x26;quot;replace&#x26;quot;: &#x26;quot;src/environments/environment.ts&#x26;quot;,
                &#x26;quot;with&#x26;quot;: &#x26;quot;src/environments/environment.qa.ts&#x26;quot;
            }
        ]
    },
    &#x26;quot;dev&#x26;quot;: {
        &#x26;quot;fileReplacements&#x26;quot;: [
            {
                &#x26;quot;replace&#x26;quot;: &#x26;quot;src/environments/environment.ts&#x26;quot;,
                &#x26;quot;with&#x26;quot;: &#x26;quot;src/environments/environment.dev.ts&#x26;quot;
            }
        ]
    }
}</code></pre></div>
<p>And finally, we update the <em>serve</em> object:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">&#x26;quot;serve&#x26;quot;: {
    &#x26;quot;builder&#x26;quot;: &#x26;quot;@angular-devkit/build-angular:dev-server&#x26;quot;,
    &#x26;quot;options&#x26;quot;: {
        &#x26;quot;browserTarget&#x26;quot;: &#x26;quot;&#x26;lt;appname&#x26;gt;:build&#x26;quot;
    },
    &#x26;quot;configurations&#x26;quot;: {
        &#x26;quot;production&#x26;quot;: ... // leave as it is
        &#x26;quot;dev&#x26;quot;: {
            &#x26;quot;browserTarget&#x26;quot;: &#x26;quot;&#x26;lt;appname&#x26;gt;:build:dev&#x26;quot;
        },
        &#x26;quot;qa&#x26;quot;: {
            &#x26;quot;browserTarget&#x26;quot;: &#x26;quot;&#x26;lt;appname&#x26;gt;:build:qa&#x26;quot;
        }
    }
},</code></pre></div>
<h2>Default Values</h2>
<p>When dealing with multiple environments, it’s common to have the same value for some of the environments. Something I normally do is to have defaults values for all environments, and I do that by creating a file called <em>enviroment.defaults.ts</em> and adding to it the values I want an environment to have by default:</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// environment.defaults.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> environmment <span class="token operator">=</span> <span class="token punctuation">{</span>
   production<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
   log<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
   flags<span class="token operator">:</span> <span class="token punctuation">{</span>
      useNewHeader<span class="token operator">:</span> <span class="token boolean">true</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>All other environments (except e_nvironment.ts_) will need to be merged with the object <em>defaultEnvironment:</em></p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// environment.dev.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defaultEnvironment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./environment.defaults.ts'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> environment <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>defaultEnvironment<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// environment.qa.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defaultEnvironment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./environment.defaults.ts'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> environment <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>defaultEnvironment<span class="token punctuation">,</span>
    production<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Obviously, I don’t want logging or an untested component in production! So we overwrite the production environment configuration:</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// environment.prod.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defaultEnvironment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./environment.defaults.ts'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> environment <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>defaultEnvironment<span class="token punctuation">,</span>

    production<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    log<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    flags<span class="token operator">:</span> <span class="token punctuation">{</span>
      useNewHeader<span class="token operator">:</span> <span class="token boolean">false</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<blockquote>
<p>💡 As this is a naive approach for merging objects, you may want to use a better way to merge deeply nested objects so you won’t have to repeat the same values.</p>
</blockquote>
<h2>Adding Npm scripts for each environment</h2>
<p>Now that we defined our custom environments, it’s time to set up an NPM script for serving our app with a custom environment. </p>
<p>The parameter we’re interested in is <code>-c</code> or <code>—-configuration</code> . Let’s extend our npm scripts with two parameters:</p>
<ul>
<li><code>-c</code> which will be used to define the environment used</li>
<li><code>—-port</code> which will be used to assign a different port for each environment, so we can run them in parallel</li>
</ul>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">// package.json

{
... // more stuff
&#x26;quot;scripts&#x26;quot;: {
   &#x26;quot;start:dev&#x26;quot;: &#x26;quot;ng serve -c=dev --port=4201&#x26;quot;
   &#x26;quot;start:qa&#x26;quot;: &#x26;quot;ng serve -c=qa --port=4202&#x26;quot;
   ...
   }
}</code></pre></div>
<p>In order to start one of the environments, simply run its relative command:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">npm run start:dev
npm run start:qa --aot // will run qa configuration using AOT mode</code></pre></div>
<h2>Importing using an alias 🤓</h2>
<p>As the environments file is located in the root folder, it can become cumbersome having to import it using its relative path. Something I’d suggest is to create an alias path using thanks to Typescript. </p>
<p>In order to do that, locate and open the <em>tsconfig.json</em> in your root folder and add to the object <em>compilerOptions</em> the following object:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">&#x26;quot;paths&#x26;quot;: {
    &#x26;quot;@environment&#x26;quot;: \[&#x26;quot;./src/environments/environment.ts&#x26;quot;\]
}</code></pre></div>
<p>And now, we will import the environment object by simply referencing “@environment” as path:</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> environment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@environment'</span><span class="token punctuation">;</span> <span class="token comment">// nice!</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-root'</span><span class="token punctuation">,</span>
    templateUrl<span class="token operator">:</span> <span class="token string">'./app.component.html'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppComponent</span> <span class="token punctuation">{</span>
    environment <span class="token operator">=</span> environment<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<blockquote>
<p>💡 It is possible your IDE will mark ‘@environment’ as not found, which is likely due to the file not being indexed by the IDE. If you’re using Webstorm, simply restart and invalidate the cache</p>
</blockquote>
<h2>Using a proxy for every environment </h2>
<p>Last but not least, we need to take into account our remote environments will be running at different addresses, which means we want to define the correct address for each environment. The CLI helps us by letting us pass the correct proxy configuration at build time.</p>
<p>My suggestion is to create a folder named <code>proxy</code> in the root, and then proceed by adding files named<code>&#x3C;env>-proxy.conf.json</code> which looks like this:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">{
  &#x26;quot;/api&#x26;quot;: {
    &#x26;quot;target&#x26;quot;: &#x26;quot;http://my.dev.env.com&#x26;quot;,
    &#x26;quot;secure&#x26;quot;: false,
    &#x26;quot;pathRewrite&#x26;quot;: {
      &#x26;quot;^/api&#x26;quot;: &#x26;quot;&#x26;quot;
    }
  }
}</code></pre></div>
<p>In the previous file, we’re telling Angular to redirect calls prefix with <code>api</code>to target specified in the configuration.</p>
<p>Now, we proceed by adding the correct proxy config to the configurations we created previously.</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">// package.json

{
... // more stuff
&#x26;quot;scripts&#x26;quot;: {
   &#x26;quot;start:dev&#x26;quot;: &#x26;quot;ng serve -c=dev --port=4201 --proxy-config=proxy/dev-proxy.conf.json&#x26;quot;
   &#x26;quot;start:qa&#x26;quot;: &#x26;quot;ng serve -c=qa --port=4202 --proxy-config=proxy/qa-proxy.conf.json&#x26;quot;
   ...
   }
}</code></pre></div>
<blockquote>
<p>💡 You could also do the same by changing it in the angular.json file, but it’s up to you.</p>
</blockquote>
<p>I find this solution particularly important as many codebases still reference endpoints paths using code logic, which in my opinion is not as safe and clean. </p>
<h2>Takeaways ⭐</h2>
<ul>
<li>Setting up multi-environments with the Angular CLI is pretty easy and powerful, add as many as you need</li>
<li>Adding configuration objects at build-time is powerful, but don’t add sensitive information</li>
<li>Adding proxies to our environments helps us avoid logic living in the code which also results in added security and simplicity</li>
</ul>
</div></div></article><div class="max-w-2xl mx-auto"></div><div class="w-full md:w-8/12 mx-auto"><script async="" data-uid="3e3126f064" src="https://thoughtful-inventor-7842.ck.page/3e3126f064/index.js"></script></div><div><hr class="border-accent-2 mt-16 mb-14"/><h3 class="text-2xl md:text-3xl text-center font-semibold my-4 md:my-12 flex flex-row space-x-4 items-center justify-center"><span>More Posts for</span> <div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img loading="lazy" style="width:28px;height:28px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></h3><section><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 md:gap-x-12 lg:gap-x-16 gap-y-20 md:gap-y-24 mb-32"><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Benchmarking Angular 12 with Webpack 5" href="/angular/webpack-5-angular12"><img style="width:100%;height:auto" class="shadow-small block hover:shadow-medium transition-shadow duration-200" src="/assets/images/posts/benchmarking-webpack-5.webp" alt="Cover Image for Benchmarking Angular 12 with Webpack 5" loading="lazy"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/webpack-5-angular12">Benchmarking Angular 12 with Webpack 5</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2021-05-14T00:00:00.322Z">May	14, 2021</time></div><span class="text-gray-600">·</span><span class="text-gray-600">2 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Angular 12 has been released and with it the much awaited Webpack 5 upgrade. In this post I benchmarked the bundle-size and compilation speed against the previous version</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Principles for creating libraries with Nx and Angular" href="/angular/how-to-organize-nx-modules-with-angular"><img style="width:100%;height:auto" class="shadow-small block hover:shadow-medium transition-shadow duration-200" src="/assets/images/posts/organize-nx-modules-ngrx.webp" alt="Cover Image for Principles for creating libraries with Nx and Angular" loading="lazy"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/how-to-organize-nx-modules-with-angular">Principles for creating libraries with Nx and Angular</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2021-02-07T00:00:00.322Z">February	7, 2021</time></div><span class="text-gray-600">·</span><span class="text-gray-600">5 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Working with Nx may be confusing. This article explains how I create Nx libraries and the principles behind my motivations</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Where to put your Angular models?" href="/angular/angular-where-to-put-models"><img style="width:100%;height:auto" class="shadow-small block hover:shadow-medium transition-shadow duration-200" src="/assets/images/posts/where-put-angular-models.webp" alt="Cover Image for Where to put your Angular models?" loading="lazy"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/angular-where-to-put-models">Where to put your Angular models?</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2020-08-03T00:00:00.322Z">August	3, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Organizing entities and models in your Angular app may be hard. This article explains where to put your entities and what mistakes to watch out for</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Using the Intersection Observer API with Angular" href="/angular/intersection-observer-with-angular"><img style="width:100%;height:auto" class="shadow-small block hover:shadow-medium transition-shadow duration-200" src="/assets/images/posts/intersection-observer.webp" alt="Cover Image for Using the Intersection Observer API with Angular" loading="lazy"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/intersection-observer-with-angular">Using the Intersection Observer API with Angular</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2020-08-01T00:00:00.322Z">August	1, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">5 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">This article shows how to build a directive with Angular that uses the Intersection Observer API to check when an element becomes visible on the page</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Setters vs ngOnChanges: which one is better?" href="/angular/setters-vs-ng-on-changes"><img style="width:100%;height:auto" class="shadow-small block hover:shadow-medium transition-shadow duration-200" src="/assets/images/posts/setters-vs-on-changes.webp" alt="Cover Image for Setters vs ngOnChanges: which one is better?" loading="lazy"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/setters-vs-ng-on-changes">Setters vs ngOnChanges: which one is better?</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2020-07-30T00:00:00.322Z">July	30, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Listening to Input changes can be done in different ways. But which one should you use?</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Async Rendering with a single Rx Operator" href="/angular/async-rendering-with-a-single-rx-operator"><img style="width:100%;height:auto" class="shadow-small block hover:shadow-medium transition-shadow duration-200" src="/assets/images/posts/async-rendering.webp" alt="Cover Image for Async Rendering with a single Rx Operator" loading="lazy"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/async-rendering-with-a-single-rx-operator">Async Rendering with a single Rx Operator</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2020-07-11T00:00:00.322Z">July	11, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Increase your app rendering performance with this simple Rx operator</p></div></div></section></div></div></main></div><footer><div class="container mx-auto px-5"><hr class="border-accent-2 mt-16 mb-14"/><div class="flex-row flex justify-between items-center my-8 md:my-12"><h2 class="font-normal tracking-tight md:tracking-tighter leading-tight"><a class="hover:underline" href="/"><b>GIANCARLO</b>BUOMPRISCO</a></h2><div class="justify-end lg:hidden flex"><button aria-label="Open Menu" class="navbar-burger" type="button"><span class="block relative w-7 rounded-sm bg-black h-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span></button></div><ul class="lg:space-x-8 px-4 hidden flex-col space-y-4 lg:space-y-0 lg:flex lg:flex-row nav"><li class="flex flex-row justify-between mb-6 lg:hidden"><h2 class="font-normal tracking-tight md:tracking-tighter leading-tight"><a class="hover:underline" href="/"><b>GIANCARLO</b>BUOMPRISCO</a></h2><div class="flex justify-end"><span class="rounded bg-gray-50 shadow-lg p-4">Close</span></div></li><li class="active:text-black text-lg lg:text-base text-gray-800 hover:text-gray-900 font-medium hover:underline"><a class="block" href="/articles">Articles</a></li><li class="active:text-black text-lg lg:text-base text-gray-800 hover:text-gray-900 font-medium hover:underline"><a class="block" href="/about">About</a></li><li class="active:text-black text-lg lg:text-base text-gray-800 hover:text-gray-900 font-medium hover:underline"><a class="block" href="/contact">Contact me</a></li></ul></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"readingTime":"5 min read","live":true,"title":"Multi-environment setup for your Angular app","date":"2019-04-19T00:00:00.322Z","slug":"multi-environment-setup-for-your-angular-app","content":"\u003cp\u003eOne of the most welcome additions to our tooling as Angular developers is certainly the Angular CLI. The CLI allows us to bootstrap an Angular app and also manage it through all its lifecycle. \u003c/p\u003e\n\u003cp\u003eOne of the best features I enjoyed using is setting up multiple environments for my projects. Most applications will probably use at the very least two environments: production and development. Most likely, larger applications will be running several environments, such as QA, RC, pre-prod, and so on.\u003c/p\u003e\n\u003ch2\u003eConfigurations\u003c/h2\u003e\n\u003cp\u003eThe Angular CLI bootstraps a new project with two files within the folder \u003ccode\u003eenvironments\u003c/code\u003e: \u003ccode\u003eenvironments.ts\u003c/code\u003e and \u003ccode\u003eenvironments.prod.ts.\u003c/code\u003e . \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003eenvironment.prod.ts\u003c/em\u003e is the configuration file that the CLI injects for us when the app is built using the production configuration\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eenvironment.ts\u003c/em\u003e is the configuration file we reference in our application, and the CLI will take care of getting the correct configuration at build time\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhat do these files look like? They’re just a simple constant object exported as “environment”, which initially looks like this:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e// environment.ts\nexport const environment = {\n  production: false\n};\n\n----------------------------\n\n// environment.prod.ts\nexport const environment = {\n  production: true\n};\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003e⚠️ As you may have guessed, these values are injected into the client at build time. So be aware — don’t pass sensitive values to this object.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThe CLI allows us to define multiple custom configurations which we will align with our infrastructure’s environments. So, for example, we can define two more environments — \u003cem\u003edev\u003c/em\u003e and \u003cem\u003eqa\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eLet’s go ahead and create two more files in the same folder which we will call \u003cem\u003eenvironment.dev.ts\u003c/em\u003e and \u003cem\u003eenvironment.qa.ts.\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eIn order to set up the environments correctly, we also need to let Angular know by adding these to the configuration file \u003cem\u003eangular.json.\u003c/em\u003e We will do this by extending the \u003cem\u003econfigurations\u003c/em\u003e object:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e... // angular.json\nconfigurations\u0026#x26;quot;: {\n    \u0026#x26;quot;production\u0026#x26;quot; {...} // leave as it is,\n\n    \u0026#x26;quot;qa\u0026#x26;quot;: {\n        \u0026#x26;quot;fileReplacements\u0026#x26;quot;: [\n            {\n                \u0026#x26;quot;replace\u0026#x26;quot;: \u0026#x26;quot;src/environments/environment.ts\u0026#x26;quot;,\n                \u0026#x26;quot;with\u0026#x26;quot;: \u0026#x26;quot;src/environments/environment.qa.ts\u0026#x26;quot;\n            }\n        ]\n    },\n    \u0026#x26;quot;dev\u0026#x26;quot;: {\n        \u0026#x26;quot;fileReplacements\u0026#x26;quot;: [\n            {\n                \u0026#x26;quot;replace\u0026#x26;quot;: \u0026#x26;quot;src/environments/environment.ts\u0026#x26;quot;,\n                \u0026#x26;quot;with\u0026#x26;quot;: \u0026#x26;quot;src/environments/environment.dev.ts\u0026#x26;quot;\n            }\n        ]\n    }\n}\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd finally, we update the \u003cem\u003eserve\u003c/em\u003e object:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e\u0026#x26;quot;serve\u0026#x26;quot;: {\n    \u0026#x26;quot;builder\u0026#x26;quot;: \u0026#x26;quot;@angular-devkit/build-angular:dev-server\u0026#x26;quot;,\n    \u0026#x26;quot;options\u0026#x26;quot;: {\n        \u0026#x26;quot;browserTarget\u0026#x26;quot;: \u0026#x26;quot;\u0026#x26;lt;appname\u0026#x26;gt;:build\u0026#x26;quot;\n    },\n    \u0026#x26;quot;configurations\u0026#x26;quot;: {\n        \u0026#x26;quot;production\u0026#x26;quot;: ... // leave as it is\n        \u0026#x26;quot;dev\u0026#x26;quot;: {\n            \u0026#x26;quot;browserTarget\u0026#x26;quot;: \u0026#x26;quot;\u0026#x26;lt;appname\u0026#x26;gt;:build:dev\u0026#x26;quot;\n        },\n        \u0026#x26;quot;qa\u0026#x26;quot;: {\n            \u0026#x26;quot;browserTarget\u0026#x26;quot;: \u0026#x26;quot;\u0026#x26;lt;appname\u0026#x26;gt;:build:qa\u0026#x26;quot;\n        }\n    }\n},\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eDefault Values\u003c/h2\u003e\n\u003cp\u003eWhen dealing with multiple environments, it’s common to have the same value for some of the environments. Something I normally do is to have defaults values for all environments, and I do that by creating a file called \u003cem\u003eenviroment.defaults.ts\u003c/em\u003e and adding to it the values I want an environment to have by default:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token comment\"\u003e// environment.defaults.ts\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e environmment \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n   production\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n   log\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n   flags\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      useNewHeader\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n   \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAll other environments (except e_nvironment.ts_) will need to be merged with the object \u003cem\u003edefaultEnvironment:\u003c/em\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token comment\"\u003e// environment.dev.ts\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e defaultEnvironment \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./environment.defaults.ts'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e environment \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token operator\"\u003e...\u003c/span\u003edefaultEnvironment\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token comment\"\u003e// environment.qa.ts\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e defaultEnvironment \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./environment.defaults.ts'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e environment \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token operator\"\u003e...\u003c/span\u003edefaultEnvironment\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    production\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eObviously, I don’t want logging or an untested component in production! So we overwrite the production environment configuration:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token comment\"\u003e// environment.prod.ts\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e defaultEnvironment \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./environment.defaults.ts'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e environment \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token operator\"\u003e...\u003c/span\u003edefaultEnvironment\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\n    production\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    log\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    flags\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      useNewHeader\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\n   \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003e💡 As this is a naive approach for merging objects, you may want to use a better way to merge deeply nested objects so you won’t have to repeat the same values.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003eAdding Npm scripts for each environment\u003c/h2\u003e\n\u003cp\u003eNow that we defined our custom environments, it’s time to set up an NPM script for serving our app with a custom environment. \u003c/p\u003e\n\u003cp\u003eThe parameter we’re interested in is \u003ccode\u003e-c\u003c/code\u003e or \u003ccode\u003e—-configuration\u003c/code\u003e . Let’s extend our npm scripts with two parameters:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-c\u003c/code\u003e which will be used to define the environment used\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e—-port\u003c/code\u003e which will be used to assign a different port for each environment, so we can run them in parallel\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e// package.json\n\n{\n... // more stuff\n\u0026#x26;quot;scripts\u0026#x26;quot;: {\n   \u0026#x26;quot;start:dev\u0026#x26;quot;: \u0026#x26;quot;ng serve -c=dev --port=4201\u0026#x26;quot;\n   \u0026#x26;quot;start:qa\u0026#x26;quot;: \u0026#x26;quot;ng serve -c=qa --port=4202\u0026#x26;quot;\n   ...\n   }\n}\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn order to start one of the environments, simply run its relative command:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003enpm run start:dev\nnpm run start:qa --aot // will run qa configuration using AOT mode\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eImporting using an alias 🤓\u003c/h2\u003e\n\u003cp\u003eAs the environments file is located in the root folder, it can become cumbersome having to import it using its relative path. Something I’d suggest is to create an alias path using thanks to Typescript. \u003c/p\u003e\n\u003cp\u003eIn order to do that, locate and open the \u003cem\u003etsconfig.json\u003c/em\u003e in your root folder and add to the object \u003cem\u003ecompilerOptions\u003c/em\u003e the following object:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e\u0026#x26;quot;paths\u0026#x26;quot;: {\n    \u0026#x26;quot;@environment\u0026#x26;quot;: \\[\u0026#x26;quot;./src/environments/environment.ts\u0026#x26;quot;\\]\n}\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd now, we will import the environment object by simply referencing “@environment” as path:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e Component \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@angular/core'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e environment \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@environment'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// nice!\u003c/span\u003e\n\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eComponent\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    selector\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'app-root'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    templateUrl\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./app.component.html'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eAppComponent\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    environment \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e environment\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003e💡 It is possible your IDE will mark ‘@environment’ as not found, which is likely due to the file not being indexed by the IDE. If you’re using Webstorm, simply restart and invalidate the cache\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003eUsing a proxy for every environment \u003c/h2\u003e\n\u003cp\u003eLast but not least, we need to take into account our remote environments will be running at different addresses, which means we want to define the correct address for each environment. The CLI helps us by letting us pass the correct proxy configuration at build time.\u003c/p\u003e\n\u003cp\u003eMy suggestion is to create a folder named \u003ccode\u003eproxy\u003c/code\u003e in the root, and then proceed by adding files named\u003ccode\u003e\u0026#x3C;env\u003e-proxy.conf.json\u003c/code\u003e which looks like this:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e{\n  \u0026#x26;quot;/api\u0026#x26;quot;: {\n    \u0026#x26;quot;target\u0026#x26;quot;: \u0026#x26;quot;http://my.dev.env.com\u0026#x26;quot;,\n    \u0026#x26;quot;secure\u0026#x26;quot;: false,\n    \u0026#x26;quot;pathRewrite\u0026#x26;quot;: {\n      \u0026#x26;quot;^/api\u0026#x26;quot;: \u0026#x26;quot;\u0026#x26;quot;\n    }\n  }\n}\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn the previous file, we’re telling Angular to redirect calls prefix with \u003ccode\u003eapi\u003c/code\u003eto target specified in the configuration.\u003c/p\u003e\n\u003cp\u003eNow, we proceed by adding the correct proxy config to the configurations we created previously.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003e// package.json\n\n{\n... // more stuff\n\u0026#x26;quot;scripts\u0026#x26;quot;: {\n   \u0026#x26;quot;start:dev\u0026#x26;quot;: \u0026#x26;quot;ng serve -c=dev --port=4201 --proxy-config=proxy/dev-proxy.conf.json\u0026#x26;quot;\n   \u0026#x26;quot;start:qa\u0026#x26;quot;: \u0026#x26;quot;ng serve -c=qa --port=4202 --proxy-config=proxy/qa-proxy.conf.json\u0026#x26;quot;\n   ...\n   }\n}\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003e💡 You could also do the same by changing it in the angular.json file, but it’s up to you.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eI find this solution particularly important as many codebases still reference endpoints paths using code logic, which in my opinion is not as safe and clean. \u003c/p\u003e\n\u003ch2\u003eTakeaways ⭐\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eSetting up multi-environments with the Angular CLI is pretty easy and powerful, add as many as you need\u003c/li\u003e\n\u003cli\u003eAdding configuration objects at build-time is powerful, but don’t add sensitive information\u003c/li\u003e\n\u003cli\u003eAdding proxies to our environments helps us avoid logic living in the code which also results in added security and simplicity\u003c/li\u003e\n\u003c/ul\u003e\n","coverImage":"/assets/images/posts/multi-environment-angular.png","collection":"angular"},"series":[],"morePosts":[{"readingTime":"2 min read","live":true,"title":"Benchmarking Angular 12 with Webpack 5","date":"2021-05-14T00:00:00.322Z","slug":"webpack-5-angular12","coverImage":"/assets/images/posts/benchmarking-webpack-5.webp","collection":"angular","excerpt":"Angular 12 has been released and with it the much awaited Webpack 5 upgrade. In this post I benchmarked the bundle-size and compilation speed against the previous version"},{"readingTime":"5 min read","live":true,"title":"Principles for creating libraries with Nx and Angular","date":"2021-02-07T00:00:00.322Z","slug":"how-to-organize-nx-modules-with-angular","coverImage":"/assets/images/posts/organize-nx-modules-ngrx.webp","collection":"angular","excerpt":"Working with Nx may be confusing. This article explains how I create Nx libraries and the principles behind my motivations"},{"readingTime":"3 min read","live":true,"title":"Where to put your Angular models?","date":"2020-08-03T00:00:00.322Z","slug":"angular-where-to-put-models","ogImage":{"url":"/assets/images/posts/where-put-angular-models.png"},"coverImage":"/assets/images/posts/where-put-angular-models.webp","collection":"angular","excerpt":"Organizing entities and models in your Angular app may be hard. This article explains where to put your entities and what mistakes to watch out for"},{"readingTime":"5 min read","live":true,"title":"Using the Intersection Observer API with Angular","date":"2020-08-01T00:00:00.322Z","slug":"intersection-observer-with-angular","coverImage":"/assets/images/posts/intersection-observer.webp","collection":"angular","excerpt":"This article shows how to build a directive with Angular that uses the Intersection Observer API to check when an element becomes visible on the page"},{"readingTime":"3 min read","live":true,"title":"Setters vs ngOnChanges: which one is better?","date":"2020-07-30T00:00:00.322Z","slug":"setters-vs-ng-on-changes","coverImage":"/assets/images/posts/setters-vs-on-changes.webp","collection":"angular","excerpt":"Listening to Input changes can be done in different ways. But which one should you use?"},{"readingTime":"3 min read","live":true,"title":"Async Rendering with a single Rx Operator","date":"2020-07-11T00:00:00.322Z","slug":"async-rendering-with-a-single-rx-operator","coverImage":"/assets/images/posts/async-rendering.webp","collection":"angular","excerpt":"Increase your app rendering performance with this simple Rx operator"}]},"__N_SSG":true},"page":"/[collection]/[slug]","query":{"collection":"angular","slug":"multi-environment-setup-for-your-angular-app"},"buildId":"FAXXTPpbWtKysjJUThVvt","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>