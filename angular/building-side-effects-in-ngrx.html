<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&amp;family=Merriweather:wght@300;400;700&amp;display=swap"/><link rel="canonical" href="https://giancarlobuomprisco.com/angular/building-side-effects-in-ngrx"/><meta name="theme-color" content="#212121"/><meta name="author" content="Giancarlo Buomprisco"/><meta property="og:site_name" content="giancarlobuomprisco.com"/><meta property="twitter:creator" content="@gc_psk"/><meta property="twitter:card" content="summary_large_image"/><title>State Management with NgRx: Building Side Effects</title><meta property="og:type" content="article"/><meta property="og:title" content="State Management with NgRx: Building Side Effects"/><meta property="article:published_time" content="2019-06-05T00:00:00.322Z"/><meta property="twitter:title" content="State Management with NgRx: Building Side Effects"/><meta property="twitter:description" content="Effects are one of the most powerful features in NGRX. Let’s see some practical examples, like calling an API or streaming real-time data"/><meta property="twitter:image" content="https://giancarlobuomprisco.com/assets/images/posts/cryptofolio-cover.gif"/><meta property="og:description" content="Effects are one of the most powerful features in NGRX. Let’s see some practical examples, like calling an API or streaming real-time data"/><meta name="description" content="Effects are one of the most powerful features in NGRX. Let’s see some practical examples, like calling an API or streaming real-time data"/><meta property="og:image" content="https://giancarlobuomprisco.com/assets/images/posts/cryptofolio-cover.gif"/><script type="application/ld+json">{&quot;@context&quot;:&quot;https://schema.org/&quot;,&quot;@type&quot;:&quot;Article&quot;,&quot;mainEntityOfPage&quot;:{&quot;@type&quot;:&quot;WebPage&quot;,&quot;@id&quot;:&quot;https://google.com/article&quot;},&quot;image&quot;:[&quot;https://giancarlobuomprisco.com/assets/images/posts/cryptofolio-cover.gif&quot;],&quot;headline&quot;:&quot;Building Side Effects&quot;,&quot;description&quot;:&quot;Effects are one of the most powerful features in NGRX. Let’s see some practical examples, like calling an API or streaming real-time data&quot;,&quot;author&quot;:{&quot;@type&quot;:&quot;Person&quot;,&quot;name&quot;:&quot;Giancarlo Buomprisco&quot;,&quot;url&quot;:&quot;https://twitter.com/@gc_psk&quot;},&quot;datePublished&quot;:&quot;2019-06-05T00:00:00.322Z&quot;}</script><meta name="next-head-count" content="28"/><link rel="preload" href="/_next/static/css/34373a9c999378cf.css" as="style"/><link rel="stylesheet" href="/_next/static/css/34373a9c999378cf.css" data-n-g=""/><link rel="preload" href="/_next/static/css/0872225b3e11ef97.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0872225b3e11ef97.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-27593bf8d60abcde.js" defer=""></script><script src="/_next/static/chunks/framework-93dc06fa7fcdddfb.js" defer=""></script><script src="/_next/static/chunks/main-e47b4831833660b7.js" defer=""></script><script src="/_next/static/chunks/pages/_app-8ff1c8d9702d8e84.js" defer=""></script><script src="/_next/static/chunks/501-5650b991910e93a7.js" defer=""></script><script src="/_next/static/chunks/506-f1e1733ed0e3b9a9.js" defer=""></script><script src="/_next/static/chunks/176-272b3cbb63989f10.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bcollection%5D/%5Bslug%5D-a70601baec9b1eb7.js" defer=""></script><script src="/_next/static/oTh8w4j-q4H0bKYXJr-fT/_buildManifest.js" defer=""></script><script src="/_next/static/oTh8w4j-q4H0bKYXJr-fT/_ssgManifest.js" defer=""></script><script src="/_next/static/oTh8w4j-q4H0bKYXJr-fT/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div><main><div style="--accent:#e23236;--accent-light:#e23236;--accent-contrast:#ffffff"><div style="--from:#dd00316e;--to:#e23236" class="collection-branding-bar_gradient__1Ie5x"></div><div class="container mx-auto px-5"><div class="flex-row flex justify-between items-center py-2 mt-6 mb-8"><a class="hover:underline" href="/"><b>GIANCARLO</b><span>BUOMPRISCO</span></a><div class="justify-end lg:hidden flex"><button aria-label="Open Menu" class="navbar-burger" type="button"><span class="block relative w-7 rounded-sm bg-black h-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span></button></div><ul class="lg:space-x-10 text-gray-800 px-4 hidden flex-col space-y-4 lg:space-y-0 lg:flex lg:flex-row nav"><li class="flex flex-row justify-between mb-6 lg:hidden"><div><a class="hover:underline" href="/"><b>GIANCARLO</b><span>BUOMPRISCO</span></a></div><div class="flex justify-end"><span class="bg-gray-100 font-bold text-sm rounded-full shadow-xl flex items-center justify-center w-16 h-16">Close</span></div></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/blog">Blog</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/articles">Articles</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/consulting">Consulting</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/about">About</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/contact">Contact me</a></li></ul></div><article class="mb-16"><h1 class="text-4xl md:text-5xl lg:text-6xl font-bold tracking-tighter mb-2 text-center" style="color:#e23236;line-height:1.2">State Management with NgRx</h1><h1 class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter md:leading-none mb-8 text-center">Building Side Effects</h1><div class="mb-6 flex space-x-3 items-center justify-center"><div style="--backgroundColor:#e23236;--color:#ffffff" class="text-center flex flex-row space-x-1 items-center cursor-pointer justify-center px-2 py-1 rounded hover:shadow-md transition-shadow font-bold tag_Tag__tPe2P"><a class="flex flex-row space-x-1 items-center justify-center" href="/angular"><img class="object-contain" loading="lazy" style="width:22px;height:22px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></a></div><div style="--backgroundColor:#eee" class="text-center flex flex-row space-x-1 items-center cursor-pointer justify-center px-2 py-1 rounded hover:shadow-md transition-shadow font-bold tag_Tag__tPe2P"><a href="/tags/ngrx">ngrx</a></div></div><div class="max-w-2xl mx-auto mb-6"><div class="flex flex-row space-x-2 items-center justify-center"><div class="flex flex-row space-x-3 items-center"><a target="_blank" rel="noreferrer noopened" href="https://twitter.com/@gc_psk"><img width="45px" height="45px" src="/assets/giancarlo-2.png"/></a><a class="text-sm text-gray-600" target="_blank" rel="noreferrer noopened" href="https://twitter.com/@gc_psk">@gc_psk</a></div><span class="text-gray-600">·</span><div class="text-sm text-center text-gray-600"><time dateTime="2019-06-05T00:00:00.322Z">Jun 5, 2019</time></div><span class="text-gray-600">·</span><span class="text-gray-600 text-sm">6 min read</span></div></div><div class="mb-8 md:mb-16 sm:mx-0"><div class="mx-auto w-12/12 lg:w-10/12 xl:w-8/12 justify-center"><div class="sm:mx-0"><img style="width:100%;height:auto" class="block shadow-xl rounded-md" src="/assets/images/posts/cryptofolio-cover.gif" alt="Cover Image for Building Side Effects" loading="lazy"/></div></div></div><div class="mb-12 max-w-2xl mx-auto"><div class="mx-auto flex flex-col"><h3 class="font-medium text-lg md:text-2xl mb-4"><b class="font-bold">State Management with NgRx<!-- --> (<!-- -->4<!-- --> Part Series)</b></h3><div class="flex flex-col space-y-4"><div class="flex flex-row items-center space-x-6"><div><div class="rounded-full cursor-pointer w-10 h-10 opacity-90 hover:opacity-100 flex items-center justify-center bg-gray-100 hover:bg-gray-200" href="/angular/state-management-with-ngrx-introduction"><span>1</span></div></div><div class="flex flex-col space-y-1"><h3 class="leading-snug text-xl"><a class="hover:underline font-medium" href="/angular/state-management-with-ngrx-introduction">Introduction</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2019-05-02T00:00:00.322Z">May 2, 2019</time></div><span class="text-gray-600">·</span><span class="text-gray-600">9 min read</span></div></div></div><div class="flex flex-row items-center space-x-6"><div><div class="rounded-full cursor-pointer w-10 h-10 opacity-90 hover:opacity-100 flex items-center justify-center bg-gray-100 hover:bg-gray-200" href="/angular/architecting-the-store-in-ngrx"><span>2</span></div></div><div class="flex flex-col space-y-1"><h3 class="leading-snug text-xl"><a class="hover:underline font-medium" href="/angular/architecting-the-store-in-ngrx">Architecting the Store</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2019-05-05T00:00:00.322Z">May 5, 2019</time></div><span class="text-gray-600">·</span><span class="text-gray-600">10 min read</span></div></div></div><div class="flex flex-row items-center space-x-6"><div><div style="background-color:#e23236" class="rounded-full cursor-pointer w-10 h-10 opacity-90 hover:opacity-100 flex items-center justify-center font-bold text-white" href="/angular/building-side-effects-in-ngrx"><span>3</span></div></div><div class="flex flex-col space-y-1"><h3 class="leading-snug text-xl"><a class="hover:underline font-bold" href="/angular/building-side-effects-in-ngrx">Building Side Effects</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2019-06-05T00:00:00.322Z">Jun 5, 2019</time></div><span class="text-gray-600">·</span><span class="text-gray-600">6 min read</span></div></div></div><div class="flex flex-row items-center space-x-6"><div><div class="rounded-full cursor-pointer w-10 h-10 opacity-90 hover:opacity-100 flex items-center justify-center bg-gray-100 hover:bg-gray-200" href="/angular/abstracting-state-with-ngrx-facades"><span>4</span></div></div><div class="flex flex-col space-y-1"><h3 class="leading-snug text-xl"><a class="hover:underline font-medium" href="/angular/abstracting-state-with-ngrx-facades">Abstracting State with Facades</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2019-06-27T00:00:00.322Z">Jun 27, 2019</time></div><span class="text-gray-600">·</span><span class="text-gray-600">10 min read</span></div></div></div></div></div></div><div class="max-w-2xl mx-auto leading-loose markdown-styles_markdown__1x9gM"><p>This is the third article of a series that aims to explain in detail a step-by-step approach to building an Angular application with NGRX.</p><ul><li>In <a href="https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fstate-management-with-ngrx-introduction-1aae0803e988" target="_blank" rel="noopener noreferrer">the first article of this series</a>, I wrote a small overview of all the concepts surrounding the NGRX platform.</li><li>In <a href="https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Farchitecting-the-store-in-ngrx-e4955641d746" target="_blank" rel="noopener noreferrer">the second article of this series</a>, I started writing the store of the application and the state’s entities.</li></ul><p>If you have never worked with NGRX, or have never done something in-depth with, I’d really recommend you read it.</p><h3>Summary</h3><p>Just to summarise what I introduced in the previous articles, we have an application that aims to display a dashboard with cryptocurrencies prices.</p><p>The application’s logic is built using three service modules, each module manages a different feature of our store.</p><p>These are:</p><ul><li><strong>dashboard</strong>, that manages the logic of the dashboard and its tiles</li><li><strong>assets,</strong> a list of assets fetched from <a href="https://medium.com/r/?url=https%3A%2F%2Fcoincap.io" target="_blank" rel="noopener noreferrer">Coincap’s</a> API</li><li><strong>prices,</strong> a stream of prices from Coincap’s WebSocket API </li></ul><h3>In this article we will be learning:</h3><ul><li>how to build effects in NGRX 8</li><li>how to build an effect that fetches the assets list from the API</li><li>how to build an effect that connects to a WebSocket and listens for messages that will be stored in our application’s state</li></ul><h3>Coincap’s API Service</h3><p>In order to fetch data from Coincap, we create a service that we’re going to use in our Effects classes:</p><div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CoincapService</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> http<span class="token operator">:</span> HttpClient<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">getAssets</span><span class="token punctuation">(</span>
        search<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        ids<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        limit <span class="token operator">=</span> <span class="token number">5</span>
    <span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>GetAssetsResponseDto<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>http<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span>GetAssetsResponseDto<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>EndPoints<span class="token punctuation">.</span>Assets<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            params<span class="token operator">:</span> <span class="token punctuation">{</span> search<span class="token punctuation">,</span> ids<span class="token punctuation">,</span> limit<span class="token operator">:</span> limit<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>At the moment, we have one single method:</p><ul><li><strong>getAssets</strong>, that by default will be fetching the first top 5 assets</li></ul><p>This method will be returning <code>GetAssetsResponseDto</code> which is simply:</p><div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">GetAssetsResponseDto</span> <span class="token punctuation">{</span>
    data<span class="token operator">:</span> Asset<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    timestamp<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2>Assets Effects</h2><p>Let’s now create the effects for the <em>Assets</em> store. As we have seen in the previous article, we have created three actions:</p><ul><li>getAssetsRequestStarted</li><li>getAssetsRequestSuccess</li><li>addAssets</li></ul><h3>Private API</h3><p>Let’s summarize what our actions will be doing:</p><ul><li>we want to react to a <em>getAssetsRequestStarted</em> action and dispatch a <em>getAssetsRequestSuccess</em> action</li><li>once <em>getAssetsRequestSuccess</em> action is received, we will dispatch <em>addAssets</em> that gets picked up by the reducer function and add the assets to the store</li></ul><p>Let’s first create the effect that will be responsible for fetching the assets:</p><div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">private</span> <span class="token function">getAllAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">createEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>actions<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
            <span class="token function">ofType</span><span class="token punctuation">(</span>getAssetsRequestStarted<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">mergeMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> payload<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>coincap<span class="token punctuation">.</span><span class="token function">getAssets</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
                    <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token operator">:</span> GetAssetsResponseDto<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token function">catchError</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">of</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>payload<span class="token operator">:</span> Asset<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">getAssetsRequestSuccess</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Let’s break this effect down</strong></p><ul><li>instead of using the decorator <code>@Effect</code> , we simply import the function <code>createEffect</code> from <code>@ngrx/effects</code> </li><li>we receive an action <code>getAssetsRequestStarted</code> </li><li>we call the <code>getAssets</code> method we defined earlier in the Coincap service, and we map the stream to the result of this request</li><li>if there’s an error, we simply return <code>undefined</code> which will be filtered in the stream thanks to <code>filter(Boolean)</code></li><li>we then map the stream to the action <code>getAssetsRequestSuccess</code> </li></ul><p>The second effect will be responsible for intercepting <code>getAssetsRequestSuccess</code> and simply map it to <code>addAssets</code> </p><div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">private</span> <span class="token function">addAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">createEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>actions<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
            <span class="token function">ofType</span><span class="token punctuation">(</span>getAssetsRequestSuccess<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> payload<span class="token operator">:</span> Asset<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                <span class="token function">addAssets</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3>Public API</h3><p>Finally, we expose the public API:</p><div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">public</span> getAllAssets$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAllAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> addAssets$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>And this is the complete snippet:</p><div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AssetsEffects</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> actions<span class="token operator">:</span> Actions<span class="token punctuation">,</span> <span class="token keyword">private</span> coincap<span class="token operator">:</span> CoincapService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> getAllAssets$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAllAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> addAssets$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token function">addAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">createEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>actions<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
                <span class="token function">ofType</span><span class="token punctuation">(</span>getAssetsRequestSuccess<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> payload<span class="token operator">:</span> Asset<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                    <span class="token function">addAssets</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token function">getAllAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">createEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>actions<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
                <span class="token function">ofType</span><span class="token punctuation">(</span>getAssetsRequestStarted<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">mergeMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> payload<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>coincap<span class="token punctuation">.</span><span class="token function">getAssets</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
                        <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token operator">:</span> GetAssetsResponseDto<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token function">catchError</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">of</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>payload<span class="token operator">:</span> Asset<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token function">getAssetsRequestSuccess</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2>Prices Effects</h2><p>In order to fetch the prices from the Coincap’s WebSocket API, we extend the Coincap service we created earlier and add a new method responsible for connecting to the price streams and returning an Observable that emits price ticks.</p><h3>WebSocket Connection </h3><p>In order to do this, we:</p><ul><li>create a connection by calling <code>WebSocket(url)</code></li><li>we create a new Observable, and inside this, we emit an event every time the WebSocket connection receives a message using the <code>onmessage</code> hook</li><li>we define the <code>unsubscribe</code> method, which will simply close the WebSocket connection</li></ul><div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CoincapService</span> <span class="token punctuation">{</span>
    <span class="token comment">// .. other methods</span>

    webSocket<span class="token operator">:</span> WebSocket<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">connectToPriceStream</span><span class="token punctuation">(</span>assets<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>PriceState<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span>assets<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Observable</span><span class="token punctuation">(</span>observer <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> webSocket <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>webSocket<span class="token punctuation">;</span>

            webSocket<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span>msg<span class="token operator">:</span> MessageEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
                    webSocket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>assets<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>webSocket<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>webSocket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>webSocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span>
            EndPoints<span class="token punctuation">.</span>WebSocket <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">?assets=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>assets<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3>API</h3><p>We have created three actions:</p><ul><li>createPriceSubscription</li><li>closePriceSubscription</li><li>addPrice</li></ul><p>And this is what the effects look like:</p><div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PricesEffects</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>
        <span class="token keyword">private</span> actions<span class="token operator">:</span> Actions<span class="token punctuation">,</span>
        <span class="token keyword">private</span> coincap<span class="token operator">:</span> CoincapService<span class="token punctuation">,</span>
        <span class="token keyword">private</span> pricesFacade<span class="token operator">:</span> PricesFacadeService
    <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    createPriceSubscription$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createPriceSubscription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    prices$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPrices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token function">createPriceSubscription</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">createEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>actions<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
                <span class="token function">ofType</span><span class="token punctuation">(</span>createPriceSubscription<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> payload<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">withLatestFrom</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pricesFacade<span class="token punctuation">.</span><span class="token function">getSubscribedAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">mergeMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>payload<span class="token punctuation">,</span> assets<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">connectPriceStream</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>assets<span class="token punctuation">,</span> payload<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>price<span class="token operator">:</span> PriceState<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">priceReceived</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload<span class="token operator">:</span> price <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token function">getPrices</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">createEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>actions<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
                <span class="token function">ofType</span><span class="token punctuation">(</span>priceReceived<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">addPrice</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token function">connectPriceStream</span><span class="token punctuation">(</span>assets<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>coincap
            <span class="token punctuation">.</span><span class="token function">connectToPriceStream</span><span class="token punctuation">(</span>assets<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
                <span class="token function">takeUntil</span><span class="token punctuation">(</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>actions<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">ofType</span><span class="token punctuation">(</span>closePriceSubscription<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Let’s break down the <code>createPriceSubscription$</code> effect:</p><ul><li>we receive an action <code>createPriceSubscription</code> </li><li>we connect to the stream via the Coincap service, which will return an <em>Observable</em> that will emit prices</li><li>every price will create an action <code>priceReceived</code> </li><li>we add a <code>takeUntil</code> operator to the price stream observable, so that every time an action <code>closePriceSubscription</code> is received, the observable will automatically be unsubscribed</li></ul><p>The <code>prices$</code> effect is fairly simple:</p><ul><li>we receive an action <code>priceReceived</code> and we map it to an action <code>addPrice</code> that will be handled by the reducer and will add the price to the store</li></ul><h3>Updating the Store Modules</h3><p>Lastly, we need to update both the store service modules by adding the effects using the method <code>EffectsModule.forFeature([EffectsClass])</code> . </p><p>The prices store module looks something like this:</p><div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">NgModule</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    imports<span class="token operator">:</span> <span class="token punctuation">[</span>
        StoreModule<span class="token punctuation">.</span><span class="token function">forFeature</span><span class="token punctuation">(</span><span class="token string">&#x27;prices&#x27;</span><span class="token punctuation">,</span> pricesReducer<span class="token punctuation">)</span><span class="token punctuation">,</span>
        EffectsModule<span class="token punctuation">.</span><span class="token function">forFeature</span><span class="token punctuation">(</span><span class="token punctuation">[</span>PricesEffects<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    providers<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// still empty!</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PricesStoreModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h2>Final Words</h2><p>In this walkthrough, we create a few very simple effects that do some very common tasks, such as talking to an API endpoint, creating streams of Observables from real-time messaging systems, and updating the reducer as a result of dispatching actions.</p><p>In the next article, we will finally build some components and connect the store to the UI using a Facade Service.</p><p>Hope you enjoyed the article and leave a message if you agree, disagree, or if you would do anything differently!</p><hr/><p><em>If you enjoyed this article, follow me on</em> <a href="https://medium.com/@.gc" target="_blank" rel="noopener noreferrer"><em>Medium</em></a> <em>or</em> <a href="https://medium.com/r/?url=https%3A%2F%2Ftwitter.com%2Fhome" target="_blank" rel="noopener noreferrer"><em>Twitter</em></a> <em>for more articles about Angular, RxJS, Typescript and more!</em></p></div></article><div class="max-w-2xl mx-auto"><div class="mx-auto flex flex-col"><h3 class="font-medium text-lg md:text-2xl mb-4"><b class="font-bold">State Management with NgRx<!-- --> (<!-- -->4<!-- --> Part Series)</b></h3><div class="flex flex-col space-y-4"><div class="flex flex-row items-center space-x-6"><div><div class="rounded-full cursor-pointer w-10 h-10 opacity-90 hover:opacity-100 flex items-center justify-center bg-gray-100 hover:bg-gray-200" href="/angular/state-management-with-ngrx-introduction"><span>1</span></div></div><div class="flex flex-col space-y-1"><h3 class="leading-snug text-xl"><a class="hover:underline font-medium" href="/angular/state-management-with-ngrx-introduction">Introduction</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2019-05-02T00:00:00.322Z">May 2, 2019</time></div><span class="text-gray-600">·</span><span class="text-gray-600">9 min read</span></div></div></div><div class="flex flex-row items-center space-x-6"><div><div class="rounded-full cursor-pointer w-10 h-10 opacity-90 hover:opacity-100 flex items-center justify-center bg-gray-100 hover:bg-gray-200" href="/angular/architecting-the-store-in-ngrx"><span>2</span></div></div><div class="flex flex-col space-y-1"><h3 class="leading-snug text-xl"><a class="hover:underline font-medium" href="/angular/architecting-the-store-in-ngrx">Architecting the Store</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2019-05-05T00:00:00.322Z">May 5, 2019</time></div><span class="text-gray-600">·</span><span class="text-gray-600">10 min read</span></div></div></div><div class="flex flex-row items-center space-x-6"><div><div style="background-color:#e23236" class="rounded-full cursor-pointer w-10 h-10 opacity-90 hover:opacity-100 flex items-center justify-center font-bold text-white" href="/angular/building-side-effects-in-ngrx"><span>3</span></div></div><div class="flex flex-col space-y-1"><h3 class="leading-snug text-xl"><a class="hover:underline font-bold" href="/angular/building-side-effects-in-ngrx">Building Side Effects</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2019-06-05T00:00:00.322Z">Jun 5, 2019</time></div><span class="text-gray-600">·</span><span class="text-gray-600">6 min read</span></div></div></div><div class="flex flex-row items-center space-x-6"><div><div class="rounded-full cursor-pointer w-10 h-10 opacity-90 hover:opacity-100 flex items-center justify-center bg-gray-100 hover:bg-gray-200" href="/angular/abstracting-state-with-ngrx-facades"><span>4</span></div></div><div class="flex flex-col space-y-1"><h3 class="leading-snug text-xl"><a class="hover:underline font-medium" href="/angular/abstracting-state-with-ngrx-facades">Abstracting State with Facades</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-600"><time dateTime="2019-06-27T00:00:00.322Z">Jun 27, 2019</time></div><span class="text-gray-600">·</span><span class="text-gray-600">10 min read</span></div></div></div></div></div></div><div class="w-full md:w-8/12 mx-auto my-4"><script async="" data-uid="3e3126f064" src="https://thoughtful-inventor-7842.ck.page/3e3126f064/index.js"></script></div><div><hr class="border-accent-2 mt-16 mb-14"/><h3 class="text-2xl md:text-3xl text-center font-semibold my-4 md:my-12 flex flex-row space-x-4 items-center justify-center"><span>Learn more about</span> <div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:28px;height:28px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></h3><section><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 md:gap-x-12 lg:gap-x-14 gap-y-16 md:gap-y-18 mb-32"><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="Benchmarking Angular 12 with Webpack 5" href="/angular/webpack-5-angular12"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="/assets/images/posts/benchmarking-webpack-5.webp" alt="Cover Image for Benchmarking Angular 12 with Webpack 5" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/webpack-5-angular12">Benchmarking Angular 12 with Webpack 5</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2021-05-14T00:00:00.322Z">May 14, 2021</time></div><span class="text-gray-600">·</span><span class="text-gray-600">2 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">Angular 12 has been released and with it the much awaited Webpack 5 upgrade. In this post I benchmarked the bundle-size and compilation speed against the previous version</p></div><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="Principles for creating libraries with Nx and Angular" href="/angular/how-to-organize-nx-modules-with-angular"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="/assets/images/posts/organize-nx-modules-ngrx.webp" alt="Cover Image for Principles for creating libraries with Nx and Angular" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/how-to-organize-nx-modules-with-angular">Principles for creating libraries with Nx and Angular</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2021-02-07T00:00:00.322Z">Feb 7, 2021</time></div><span class="text-gray-600">·</span><span class="text-gray-600">5 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">Working with Nx may be confusing. This article explains how I create Nx libraries and the principles behind my motivations</p></div><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="Where to put your Angular models?" href="/angular/angular-where-to-put-models"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="/assets/images/posts/where-put-angular-models.webp" alt="Cover Image for Where to put your Angular models?" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/angular-where-to-put-models">Where to put your Angular models?</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2020-08-03T00:00:00.322Z">Aug 3, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">Organizing entities and models in your Angular app may be hard. This article explains where to put your entities and what mistakes to watch out for</p></div><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="Using the Intersection Observer API with Angular" href="/angular/intersection-observer-with-angular"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="/assets/images/posts/intersection-observer.webp" alt="Cover Image for Using the Intersection Observer API with Angular" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/intersection-observer-with-angular">Using the Intersection Observer API with Angular</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2020-08-01T00:00:00.322Z">Aug 1, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">5 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">This article shows how to build a directive with Angular that uses the Intersection Observer API to check when an element becomes visible on the page</p></div><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="Setters vs ngOnChanges: which one is better?" href="/angular/setters-vs-ng-on-changes"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="/assets/images/posts/setters-vs-on-changes.webp" alt="Cover Image for Setters vs ngOnChanges: which one is better?" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/setters-vs-ng-on-changes">Setters vs ngOnChanges: which one is better?</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2020-07-30T00:00:00.322Z">Jul 30, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">Listening to Input changes can be done in different ways. But which one should you use?</p></div><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="Async Rendering with a single Rx Operator" href="/angular/async-rendering-with-a-single-rx-operator"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="/assets/images/posts/async-rendering.webp" alt="Cover Image for Async Rendering with a single Rx Operator" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/async-rendering-with-a-single-rx-operator">Async Rendering with a single Rx Operator</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2020-07-11T00:00:00.322Z">Jul 11, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">Increase your app rendering performance with this simple Rx operator</p></div></div></section></div></div></div></main></div><footer><div class="container mx-auto px-5"><hr class="border-accent-2 mt-16 mb-14"/><div class="flex-row flex justify-between items-center py-2 mt-6 mb-8"><a class="hover:underline" href="/"><b>GIANCARLO</b><span>BUOMPRISCO</span></a><div class="justify-end lg:hidden flex"><button aria-label="Open Menu" class="navbar-burger" type="button"><span class="block relative w-7 rounded-sm bg-black h-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span></button></div><ul class="lg:space-x-10 text-gray-800 px-4 hidden flex-col space-y-4 lg:space-y-0 lg:flex lg:flex-row nav"><li class="flex flex-row justify-between mb-6 lg:hidden"><div><a class="hover:underline" href="/"><b>GIANCARLO</b><span>BUOMPRISCO</span></a></div><div class="flex justify-end"><span class="bg-gray-100 font-bold text-sm rounded-full shadow-xl flex items-center justify-center w-16 h-16">Close</span></div></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/blog">Blog</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/articles">Articles</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/consulting">Consulting</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/about">About</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/contact">Contact me</a></li></ul></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"live":true,"readingTime":"6 min read","title":"Building Side Effects","date":"2019-06-05T00:00:00.322Z","slug":"building-side-effects-in-ngrx","coverImage":"/assets/images/posts/cryptofolio-cover.gif","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Effects are one of the most powerful features in NGRX. Let’s see some practical examples, like calling an API or streaming real-time data","series":"State Management with NgRx","content":"\nThis is the third article of a series that aims to explain in detail a step-by-step approach to building an Angular application with NGRX.\n\n*   In [the first article of this series](https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fstate-management-with-ngrx-introduction-1aae0803e988), I wrote a small overview of all the concepts surrounding the NGRX platform.\n*   In [the second article of this series](https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Farchitecting-the-store-in-ngrx-e4955641d746), I started writing the store of the application and the state’s entities.\n\nIf you have never worked with NGRX, or have never done something in-depth with, I’d really recommend you read it.\n\n### Summary\n\nJust to summarise what I introduced in the previous articles, we have an application that aims to display a dashboard with cryptocurrencies prices.\n\nThe application’s logic is built using three service modules, each module manages a different feature of our store.\n\nThese are:\n\n*   **dashboard**, that manages the logic of the dashboard and its tiles\n*   **assets,** a list of assets fetched from [Coincap’s](https://medium.com/r/?url=https%3A%2F%2Fcoincap.io) API\n*   **prices,** a stream of prices from Coincap’s WebSocket API \n\n### In this article we will be learning:\n\n*   how to build effects in NGRX 8\n*   how to build an effect that fetches the assets list from the API\n*   how to build an effect that connects to a WebSocket and listens for messages that will be stored in our application’s state\n\n### Coincap’s API Service\n\nIn order to fetch data from Coincap, we create a service that we’re going to use in our Effects classes:\n\n```typescript\n@Injectable()\nexport class CoincapService {\n    constructor(private http: HttpClient) {}\n\n    public getAssets(\n        search: string[],\n        ids: string[] = [],\n        limit = 5\n    ): Observable\u003cGetAssetsResponseDto\u003e {\n        return this.http.get\u003cGetAssetsResponseDto\u003e(EndPoints.Assets, {\n            params: { search, ids, limit: limit.toString() }\n        });\n    }\n}\n```\n\nAt the moment, we have one single method:\n\n*   **getAssets**, that by default will be fetching the first top 5 assets\n\nThis method will be returning `GetAssetsResponseDto` which is simply:\n\n```typescript\ninterface GetAssetsResponseDto {\n    data: Asset[];\n    timestamp: number;\n}\n```\n\n## Assets Effects\n\nLet’s now create the effects for the _Assets_ store. As we have seen in the previous article, we have created three actions:\n\n*   getAssetsRequestStarted\n*   getAssetsRequestSuccess\n*   addAssets\n\n### Private API\n\nLet’s summarize what our actions will be doing:\n\n*   we want to react to a _getAssetsRequestStarted_ action and dispatch a _getAssetsRequestSuccess_ action\n*   once _getAssetsRequestSuccess_ action is received, we will dispatch _addAssets_ that gets picked up by the reducer function and add the assets to the store\n\nLet’s first create the effect that will be responsible for fetching the assets:\n\n```typescript\nprivate getAllAssets() {\n    return createEffect(() =\u003e\n        this.actions.pipe(\n            ofType(getAssetsRequestStarted.type),\n            mergeMap(({ payload }: { payload: string[] }) =\u003e\n                this.coincap.getAssets(payload).pipe(\n                    map((response: GetAssetsResponseDto) =\u003e response.data),\n                    catchError(() =\u003e of(undefined))\n                )\n            ),\n            filter(Boolean),\n            map((payload: Asset[]) =\u003e {\n                return getAssetsRequestSuccess({ payload });\n            })\n        )\n    );\n}\n```\n\n**Let’s break this effect down**\n\n*   instead of using the decorator `@Effect` , we simply import the function `createEffect` from `@ngrx/effects` \n*   we receive an action `getAssetsRequestStarted` \n*   we call the `getAssets` method we defined earlier in the Coincap service, and we map the stream to the result of this request\n*   if there’s an error, we simply return `undefined` which will be filtered in the stream thanks to `filter(Boolean)`\n*   we then map the stream to the action `getAssetsRequestSuccess` \n\nThe second effect will be responsible for intercepting `getAssetsRequestSuccess` and simply map it to `addAssets` \n\n```typescript\nprivate addAssets() {\n    return createEffect(() =\u003e\n        this.actions.pipe(\n            ofType(getAssetsRequestSuccess.type),\n            map(({ payload }: { payload: Asset[] }) =\u003e\n                addAssets({ payload })\n            )\n        )\n    );\n}\n```\n\n### Public API\n\nFinally, we expose the public API:\n\n```typescript\npublic getAllAssets$ = this.getAllAssets();\npublic addAssets$ = this.addAssets();\n```\n\nAnd this is the complete snippet:\n\n```typescript\n@Injectable()\nexport class AssetsEffects {\n    constructor(private actions: Actions, private coincap: CoincapService) {}\n\n    public getAllAssets$ = this.getAllAssets();\n    public addAssets$ = this.addAssets();\n\n    private addAssets() {\n        return createEffect(() =\u003e\n            this.actions.pipe(\n                ofType(getAssetsRequestSuccess.type),\n                map(({ payload }: { payload: Asset[] }) =\u003e\n                    addAssets({ payload })\n                )\n            )\n        );\n    }\n\n    private getAllAssets() {\n        return createEffect(() =\u003e\n            this.actions.pipe(\n                ofType(getAssetsRequestStarted.type),\n                mergeMap(({ payload }: { payload: string[] }) =\u003e\n                    this.coincap.getAssets(payload).pipe(\n                        map((response: GetAssetsResponseDto) =\u003e response.data),\n                        catchError(() =\u003e of(undefined))\n                    )\n                ),\n                filter(Boolean),\n                map((payload: Asset[]) =\u003e {\n                    return getAssetsRequestSuccess({ payload });\n                })\n            )\n        );\n    }\n}\n```\n\n## Prices Effects\n\nIn order to fetch the prices from the Coincap’s WebSocket API, we extend the Coincap service we created earlier and add a new method responsible for connecting to the price streams and returning an Observable that emits price ticks.\n\n### WebSocket Connection \n\nIn order to do this, we:\n\n*   create a connection by calling `WebSocket(url)`\n*   we create a new Observable, and inside this, we emit an event every time the WebSocket connection receives a message using the `onmessage` hook\n*   we define the `unsubscribe` method, which will simply close the WebSocket connection\n\n```typescript\nexport class CoincapService {\n    // .. other methods\n\n    webSocket: WebSocket;\n\n    public connectToPriceStream(assets: string[]): Observable\u003cPriceState\u003e {\n        this.createConnection(assets);\n\n        return new Observable(observer =\u003e {\n            const webSocket = this.webSocket;\n\n            webSocket.onmessage = (msg: MessageEvent) =\u003e {\n                observer.next(JSON.parse(msg.data));\n            };\n\n            return {\n                unsubscribe(): void {\n                    webSocket.close();\n                }\n            };\n        });\n    }\n\n    private createConnection(assets: string[]) {\n        if (this.webSocket) {\n            this.webSocket.close();\n        }\n\n        this.webSocket = new WebSocket(\n            EndPoints.WebSocket + `?assets=${assets}`\n        );\n    }\n}\n```\n\n### API\n\nWe have created three actions:\n\n*   createPriceSubscription\n*   closePriceSubscription\n*   addPrice\n\nAnd this is what the effects look like:\n\n```typescript\n@Injectable()\nexport class PricesEffects {\n    constructor(\n        private actions: Actions,\n        private coincap: CoincapService,\n        private pricesFacade: PricesFacadeService\n    ) {}\n\n    createPriceSubscription$ = this.createPriceSubscription();\n    prices$ = this.getPrices();\n\n    private createPriceSubscription() {\n        return createEffect(() =\u003e\n            this.actions.pipe(\n                ofType(createPriceSubscription.type),\n                map(({ payload }) =\u003e payload),\n                withLatestFrom(this.pricesFacade.getSubscribedAssets()),\n                mergeMap(([payload, assets]: [string, string[]]) =\u003e {\n                    return this.connectPriceStream([...assets, payload]);\n                }),\n                map((price: PriceState) =\u003e priceReceived({ payload: price }))\n            )\n        );\n    }\n\n    private getPrices() {\n        return createEffect(() =\u003e\n            this.actions.pipe(\n                ofType(priceReceived.type),\n                map(({ payload }) =\u003e addPrice({ payload }))\n            )\n        );\n    }\n\n    private connectPriceStream(assets: string[]) {\n        return this.coincap\n            .connectToPriceStream(assets)\n            .pipe(\n                takeUntil(\n                    this.actions.pipe(ofType(closePriceSubscription.type))\n                )\n            );\n    }\n}\n```\n\nLet’s break down the `createPriceSubscription$` effect:\n\n*   we receive an action `createPriceSubscription` \n*   we connect to the stream via the Coincap service, which will return an _Observable_ that will emit prices\n*   every price will create an action `priceReceived` \n*   we add a `takeUntil` operator to the price stream observable, so that every time an action `closePriceSubscription` is received, the observable will automatically be unsubscribed\n\nThe `prices$` effect is fairly simple:\n\n*   we receive an action `priceReceived` and we map it to an action `addPrice` that will be handled by the reducer and will add the price to the store\n\n### Updating the Store Modules\n\nLastly, we need to update both the store service modules by adding the effects using the method `EffectsModule.forFeature([EffectsClass])` . \n\nThe prices store module looks something like this:\n\n```typescript\n@NgModule({\n    imports: [\n        StoreModule.forFeature('prices', pricesReducer),\n        EffectsModule.forFeature([PricesEffects])\n    ],\n    providers: [\n        // still empty!\n    ]\n})\nexport class PricesStoreModule {}\n```\n\n## Final Words\n\nIn this walkthrough, we create a few very simple effects that do some very common tasks, such as talking to an API endpoint, creating streams of Observables from real-time messaging systems, and updating the reducer as a result of dispatching actions.\n\nIn the next article, we will finally build some components and connect the store to the UI using a Facade Service.\n\nHope you enjoyed the article and leave a message if you agree, disagree, or if you would do anything differently!\n\n* * *\n\n_If you enjoyed this article, follow me on_ [_Medium_](https://medium.com/@.gc) _or_ [_Twitter_](https://medium.com/r/?url=https%3A%2F%2Ftwitter.com%2Fhome) _for more articles about Angular, RxJS, Typescript and more!_\n","tags":["ngrx","angular"]},"content":{"compiledSource":"var i=Object.defineProperty,u=Object.defineProperties;var l=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;var m=(e,n,s)=\u003en in e?i(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,a=(e,n)=\u003e{for(var s in n||(n={}))o.call(n,s)\u0026\u0026m(e,s,n[s]);if(p)for(var s of p(n))c.call(n,s)\u0026\u0026m(e,s,n[s]);return e},N=(e,n)=\u003eu(e,l(n));var r=(e,n)=\u003e{var s={};for(var t in e)o.call(e,t)\u0026\u0026n.indexOf(t)\u003c0\u0026\u0026(s[t]=e[t]);if(e!=null\u0026\u0026p)for(var t of p(e))n.indexOf(t)\u003c0\u0026\u0026c.call(e,t)\u0026\u0026(s[t]=e[t]);return s};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(s){var t=s,{components:e}=t,n=r(t,[\"components\"]);return mdx(MDXLayout,N(a(a({},layoutProps),n),{components:e,mdxType:\"MDXLayout\"}),mdx(\"p\",null,\"This is the third article of a series that aims to explain in detail a step-by-step approach to building an Angular application with NGRX.\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"In \",mdx(\"a\",a({parentName:\"li\"},{href:\"https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fstate-management-with-ngrx-introduction-1aae0803e988\"}),\"the first article of this series\"),\", I wrote a small overview of all the concepts surrounding the NGRX platform.\"),mdx(\"li\",{parentName:\"ul\"},\"In \",mdx(\"a\",a({parentName:\"li\"},{href:\"https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Farchitecting-the-store-in-ngrx-e4955641d746\"}),\"the second article of this series\"),\", I started writing the store of the application and the state\\u2019s entities.\")),mdx(\"p\",null,\"If you have never worked with NGRX, or have never done something in-depth with, I\\u2019d really recommend you read it.\"),mdx(\"h3\",null,\"Summary\"),mdx(\"p\",null,\"Just to summarise what I introduced in the previous articles, we have an application that aims to display a dashboard with cryptocurrencies prices.\"),mdx(\"p\",null,\"The application\\u2019s logic is built using three service modules, each module manages a different feature of our store.\"),mdx(\"p\",null,\"These are:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"dashboard\"),\", that manages the logic of the dashboard and its tiles\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"assets,\"),\" a list of assets fetched from \",mdx(\"a\",a({parentName:\"li\"},{href:\"https://medium.com/r/?url=https%3A%2F%2Fcoincap.io\"}),\"Coincap\\u2019s\"),\" API\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"prices,\"),\" a stream of prices from Coincap\\u2019s WebSocket API\\xA0\")),mdx(\"h3\",null,\"In this article we will be learning:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"how to build effects in NGRX 8\"),mdx(\"li\",{parentName:\"ul\"},\"how to build an effect that fetches the assets list from the API\"),mdx(\"li\",{parentName:\"ul\"},\"how to build an effect that connects to a WebSocket and listens for messages that will be stored in our application\\u2019s state\")),mdx(\"h3\",null,\"Coincap\\u2019s API\\xA0Service\"),mdx(\"p\",null,\"In order to fetch data from Coincap, we create a service that we\\u2019re going to use in our Effects classes:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-typescript\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-typescript\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token decorator\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token at operator\"}),\"@\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"Injectable\")),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"CoincapService\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"constructor\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" http\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" HttpClient\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"public\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n        search`,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"string\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n        ids`,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"string\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n        limit `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"5\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" Observable\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"\u003c\"),\"GetAssetsResponseDto\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"\u003e\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"http\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token generic-function\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"get\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token generic class-name\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"\u003c\"),\"GetAssetsResponseDto\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"\u003e\"))),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"EndPoints\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"Assets\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n            params`,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" search\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" ids\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" limit\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" limit\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"toString\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`))),mdx(\"p\",null,\"At the moment, we have one single method:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"getAssets\"),\", that by default will be fetching the first top 5 assets\")),mdx(\"p\",null,\"This method will be returning \",mdx(\"inlineCode\",{parentName:\"p\"},\"GetAssetsResponseDto\"),\" which is simply:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-typescript\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-typescript\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"interface\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"GetAssetsResponseDto\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n    data`,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" Asset\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n    timestamp`,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"number\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`))),mdx(\"h2\",null,\"Assets Effects\"),mdx(\"p\",null,\"Let\\u2019s now create the effects for the \",mdx(\"em\",{parentName:\"p\"},\"Assets\"),\" store. As we have seen in the previous article, we have created three actions:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"getAssetsRequestStarted\"),mdx(\"li\",{parentName:\"ul\"},\"getAssetsRequestSuccess\"),mdx(\"li\",{parentName:\"ul\"},\"addAssets\")),mdx(\"h3\",null,\"Private API\"),mdx(\"p\",null,\"Let\\u2019s summarize what our actions will be doing:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"we want to react to a \",mdx(\"em\",{parentName:\"li\"},\"getAssetsRequestStarted\"),\" action and dispatch a \",mdx(\"em\",{parentName:\"li\"},\"getAssetsRequestSuccess\"),\" action\"),mdx(\"li\",{parentName:\"ul\"},\"once \",mdx(\"em\",{parentName:\"li\"},\"getAssetsRequestSuccess\"),\" action is received, we will dispatch \",mdx(\"em\",{parentName:\"li\"},\"addAssets\"),\" that gets picked up by the reducer function and add the assets to the store\")),mdx(\"p\",null,\"Let\\u2019s first create the effect that will be responsible for fetching the assets:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-typescript\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-typescript\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getAllAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"createEffect\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"actions\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"pipe\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"ofType\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"getAssetsRequestStarted\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"type\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"mergeMap\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"string\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"coincap\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"pipe\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n                    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"map\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"response\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" GetAssetsResponseDto\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" response\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"data\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"catchError\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"of\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"undefined\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"filter\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"Boolean\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"map\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" Asset\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getAssetsRequestSuccess\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`))),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Let\\u2019s break this effect down\")),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"instead of using the decorator \",mdx(\"inlineCode\",{parentName:\"li\"},\"@Effect\"),\"\\xA0, we simply import the function \",mdx(\"inlineCode\",{parentName:\"li\"},\"createEffect\"),\" from \",mdx(\"inlineCode\",{parentName:\"li\"},\"@ngrx/effects\"),\"\\xA0\"),mdx(\"li\",{parentName:\"ul\"},\"we receive an action \",mdx(\"inlineCode\",{parentName:\"li\"},\"getAssetsRequestStarted\"),\"\\xA0\"),mdx(\"li\",{parentName:\"ul\"},\"we call the \",mdx(\"inlineCode\",{parentName:\"li\"},\"getAssets\"),\" method we defined earlier in the Coincap service, and we map the stream to the result of this request\"),mdx(\"li\",{parentName:\"ul\"},\"if there\\u2019s an error, we simply return \",mdx(\"inlineCode\",{parentName:\"li\"},\"undefined\"),\" which will be filtered in the stream thanks to \",mdx(\"inlineCode\",{parentName:\"li\"},\"filter(Boolean)\")),mdx(\"li\",{parentName:\"ul\"},\"we then map the stream to the action \",mdx(\"inlineCode\",{parentName:\"li\"},\"getAssetsRequestSuccess\"),\"\\xA0\")),mdx(\"p\",null,\"The second effect will be responsible for intercepting \",mdx(\"inlineCode\",{parentName:\"p\"},\"getAssetsRequestSuccess\"),\" and simply map it to \",mdx(\"inlineCode\",{parentName:\"p\"},\"addAssets\"),\"\\xA0\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-typescript\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-typescript\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"addAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"createEffect\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"actions\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"pipe\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"ofType\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"getAssetsRequestSuccess\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"type\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"map\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" Asset\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"addAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`))),mdx(\"h3\",null,\"Public API\"),mdx(\"p\",null,\"Finally, we expose the public API:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-typescript\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-typescript\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"public\"),\" getAllAssets$ \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getAllAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"public\"),\" addAssets$ \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"addAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n`))),mdx(\"p\",null,\"And this is the complete snippet:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-typescript\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-typescript\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token decorator\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token at operator\"}),\"@\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"Injectable\")),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"AssetsEffects\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"constructor\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" actions\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" Actions\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" coincap\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" CoincapService\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"public\"),\" getAllAssets$ \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getAllAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"public\"),\" addAssets$ \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"addAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"addAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"createEffect\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"actions\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"pipe\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"ofType\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"getAssetsRequestSuccess\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"type\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"map\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" Asset\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),`\n                    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"addAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getAllAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"createEffect\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"actions\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"pipe\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"ofType\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"getAssetsRequestStarted\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"type\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"mergeMap\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"string\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),`\n                    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"coincap\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"pipe\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n                        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"map\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"response\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" GetAssetsResponseDto\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" response\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"data\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"catchError\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"of\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"undefined\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n                    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"filter\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"Boolean\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"map\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" Asset\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n                    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getAssetsRequestSuccess\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`))),mdx(\"h2\",null,\"Prices Effects\"),mdx(\"p\",null,\"In order to fetch the prices from the Coincap\\u2019s WebSocket API, we extend the Coincap service we created earlier and add a new method responsible for connecting to the price streams and returning an Observable that emits price ticks.\"),mdx(\"h3\",null,\"WebSocket Connection\\xA0\"),mdx(\"p\",null,\"In order to do this, we:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"create a connection by calling \",mdx(\"inlineCode\",{parentName:\"li\"},\"WebSocket(url)\")),mdx(\"li\",{parentName:\"ul\"},\"we create a new Observable, and inside this, we emit an event every time the WebSocket connection receives a message using the \",mdx(\"inlineCode\",{parentName:\"li\"},\"onmessage\"),\" hook\"),mdx(\"li\",{parentName:\"ul\"},\"we define the \",mdx(\"inlineCode\",{parentName:\"li\"},\"unsubscribe\"),\" method, which will simply close the WebSocket connection\")),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-typescript\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-typescript\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"CoincapService\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"// .. other methods\"),`\n\n    webSocket`,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" WebSocket\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"public\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"connectToPriceStream\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"assets\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"string\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" Observable\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"\u003c\"),\"PriceState\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"\u003e\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"createConnection\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"assets\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"new\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"Observable\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"observer \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"const\"),\" webSocket \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"webSocket\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n            webSocket`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function-variable function\"}),\"onmessage\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"msg\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" MessageEvent\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n                observer`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"next\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token constant\"}),\"JSON\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"parse\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"msg\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"data\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"unsubscribe\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"void\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n                    webSocket`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"close\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"createConnection\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"assets\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"string\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"if\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"webSocket\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"webSocket\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"close\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"webSocket \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"new\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"WebSocket\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n            EndPoints`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"WebSocket \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"+\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token template-string\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token template-punctuation string\"}),\"`\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),\"?assets=\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation-punctuation punctuation\"}),\"${\"),\"assets\",mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation-punctuation punctuation\"}),\"}\")),mdx(\"span\",a({parentName:\"span\"},{className:\"token template-punctuation string\"}),\"`\")),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`))),mdx(\"h3\",null,\"API\"),mdx(\"p\",null,\"We have created three actions:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"createPriceSubscription\"),mdx(\"li\",{parentName:\"ul\"},\"closePriceSubscription\"),mdx(\"li\",{parentName:\"ul\"},\"addPrice\")),mdx(\"p\",null,\"And this is what the effects look like:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-typescript\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-typescript\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token decorator\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token at operator\"}),\"@\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"Injectable\")),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"PricesEffects\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"constructor\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" actions\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" Actions\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" coincap\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" CoincapService\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" pricesFacade\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),` PricesFacadeService\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n\n    createPriceSubscription$ `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"createPriceSubscription\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n    prices$ `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getPrices\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"createPriceSubscription\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"createEffect\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"actions\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"pipe\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"ofType\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"createPriceSubscription\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"type\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"map\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"withLatestFrom\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"pricesFacade\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getSubscribedAssets\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"mergeMap\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" assets\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"string\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"string\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n                    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"connectPriceStream\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"...\"),\"assets\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"map\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"price\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" PriceState\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"priceReceived\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" price \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"getPrices\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"createEffect\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"actions\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"pipe\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"ofType\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"priceReceived\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"type\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"map\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"addPrice\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" payload \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"private\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"connectPriceStream\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"assets\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"string\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`coincap\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"connectToPriceStream\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"assets\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"pipe\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"takeUntil\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n                    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"this\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"actions\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"pipe\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"ofType\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"closePriceSubscription\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"type\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n                `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`))),mdx(\"p\",null,\"Let\\u2019s break down the \",mdx(\"inlineCode\",{parentName:\"p\"},\"createPriceSubscription$\"),\" effect:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"we receive an action \",mdx(\"inlineCode\",{parentName:\"li\"},\"createPriceSubscription\"),\"\\xA0\"),mdx(\"li\",{parentName:\"ul\"},\"we connect to the stream via the Coincap service, which will return an \",mdx(\"em\",{parentName:\"li\"},\"Observable\"),\" that will emit prices\"),mdx(\"li\",{parentName:\"ul\"},\"every price will create an action \",mdx(\"inlineCode\",{parentName:\"li\"},\"priceReceived\"),\"\\xA0\"),mdx(\"li\",{parentName:\"ul\"},\"we add a \",mdx(\"inlineCode\",{parentName:\"li\"},\"takeUntil\"),\" operator to the price stream observable, so that every time an action \",mdx(\"inlineCode\",{parentName:\"li\"},\"closePriceSubscription\"),\" is received, the observable will automatically be unsubscribed\")),mdx(\"p\",null,\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"prices$\"),\" effect is fairly simple:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"we receive an action \",mdx(\"inlineCode\",{parentName:\"li\"},\"priceReceived\"),\" and we map it to an action \",mdx(\"inlineCode\",{parentName:\"li\"},\"addPrice\"),\" that will be handled by the reducer and will add the price to the store\")),mdx(\"h3\",null,\"Updating the Store\\xA0Modules\"),mdx(\"p\",null,\"Lastly, we need to update both the store service modules by adding the effects using the method \",mdx(\"inlineCode\",{parentName:\"p\"},\"EffectsModule.forFeature([EffectsClass])\"),\"\\xA0.\\xA0\"),mdx(\"p\",null,\"The prices store module looks something like this:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-typescript\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-typescript\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token decorator\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token at operator\"}),\"@\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"NgModule\")),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n    imports`,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        StoreModule`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"forFeature\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),\"'prices'\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" pricesReducer\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n        EffectsModule`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"forFeature\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"PricesEffects\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    providers`,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"// still empty!\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"PricesStoreModule\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`))),mdx(\"h2\",null,\"Final Words\"),mdx(\"p\",null,\"In this walkthrough, we create a few very simple effects that do some very common tasks, such as talking to an API endpoint, creating streams of Observables from real-time messaging systems, and updating the reducer as a result of dispatching actions.\"),mdx(\"p\",null,\"In the next article, we will finally build some components and connect the store to the UI using a Facade Service.\"),mdx(\"p\",null,\"Hope you enjoyed the article and leave a message if you agree, disagree, or if you would do anything differently!\"),mdx(\"hr\",null),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"If you enjoyed this article, follow me on\"),\" \",mdx(\"a\",a({parentName:\"p\"},{href:\"https://medium.com/@.gc\"}),mdx(\"em\",{parentName:\"a\"},\"Medium\")),\" \",mdx(\"em\",{parentName:\"p\"},\"or\"),\" \",mdx(\"a\",a({parentName:\"p\"},{href:\"https://medium.com/r/?url=https%3A%2F%2Ftwitter.com%2Fhome\"}),mdx(\"em\",{parentName:\"a\"},\"Twitter\")),\" \",mdx(\"em\",{parentName:\"p\"},\"for more articles about Angular, RxJS, Typescript and more!\")))}MDXContent.isMDXComponent=!0;\n","scope":{}},"series":[{"live":true,"readingTime":"9 min read","title":"Introduction","date":"2019-05-02T00:00:00.322Z","slug":"state-management-with-ngrx-introduction","coverImage":"/assets/images/posts/stae-managemen-with-ngrx.png","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"An Introduction to the NGRX platform — Concepts, Best Practices, and Tips","series":"State Management with NgRx","tags":["ngrx","angular"]},{"live":true,"readingTime":"10 min read","title":"Architecting the Store","date":"2019-05-05T00:00:00.322Z","slug":"architecting-the-store-in-ngrx","coverImage":"/assets/images/posts/architecting-store-ngrx.png","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"A step-by-step guide to building and architecting the Store in NGRX","series":"State Management with NgRx","tags":["ngrx","angular"]},{"live":true,"readingTime":"6 min read","title":"Building Side Effects","date":"2019-06-05T00:00:00.322Z","slug":"building-side-effects-in-ngrx","coverImage":"/assets/images/posts/cryptofolio-cover.gif","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Effects are one of the most powerful features in NGRX. Let’s see some practical examples, like calling an API or streaming real-time data","series":"State Management with NgRx","tags":["ngrx","angular"]},{"live":true,"readingTime":"10 min read","title":"Abstracting State with Facades","date":"2019-06-27T00:00:00.322Z","slug":"abstracting-state-with-ngrx-facades","coverImage":"/assets/images/posts/state-management-with-ngrx.png","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Using Ngrx facades to connect your components with your state","series":"State Management with NgRx","tags":["angular","ngrx"]}],"morePosts":[],"moreArticles":[{"live":true,"readingTime":"2 min read","title":"Benchmarking Angular 12 with Webpack 5","date":"2021-05-14T00:00:00.322Z","slug":"webpack-5-angular12","coverImage":"/assets/images/posts/benchmarking-webpack-5.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Angular 12 has been released and with it the much awaited Webpack 5 upgrade. In this post I benchmarked the bundle-size and compilation speed against the previous version","tags":["angular"]},{"live":true,"readingTime":"5 min read","title":"Principles for creating libraries with Nx and Angular","date":"2021-02-07T00:00:00.322Z","slug":"how-to-organize-nx-modules-with-angular","coverImage":"/assets/images/posts/organize-nx-modules-ngrx.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Working with Nx may be confusing. This article explains how I create Nx libraries and the principles behind my motivations","tags":["nx","angular"]},{"live":true,"readingTime":"3 min read","title":"Where to put your Angular models?","date":"2020-08-03T00:00:00.322Z","slug":"angular-where-to-put-models","ogImage":{"url":"/assets/images/posts/where-put-angular-models.png"},"coverImage":"/assets/images/posts/where-put-angular-models.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Organizing entities and models in your Angular app may be hard. This article explains where to put your entities and what mistakes to watch out for","tags":["angular","architecture"]},{"live":true,"readingTime":"5 min read","title":"Using the Intersection Observer API with Angular","date":"2020-08-01T00:00:00.322Z","slug":"intersection-observer-with-angular","coverImage":"/assets/images/posts/intersection-observer.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"This article shows how to build a directive with Angular that uses the Intersection Observer API to check when an element becomes visible on the page","tags":["angular","performance"]},{"live":true,"readingTime":"3 min read","title":"Setters vs ngOnChanges: which one is better?","date":"2020-07-30T00:00:00.322Z","slug":"setters-vs-ng-on-changes","coverImage":"/assets/images/posts/setters-vs-on-changes.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Listening to Input changes can be done in different ways. But which one should you use?","tags":["angular"]},{"live":true,"readingTime":"3 min read","title":"Async Rendering with a single Rx Operator","date":"2020-07-11T00:00:00.322Z","slug":"async-rendering-with-a-single-rx-operator","coverImage":"/assets/images/posts/async-rendering.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Increase your app rendering performance with this simple Rx operator","tags":["angular","rxjs"]}],"type":1},"__N_SSG":true},"page":"/[collection]/[slug]","query":{"collection":"angular","slug":"building-side-effects-in-ngrx"},"buildId":"oTh8w4j-q4H0bKYXJr-fT","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script async="" defer="" src="https://www.googletagmanager.com/gtag/js"></script><script id="gtmDataLayer">
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-172483071-1');
</script></body></html>