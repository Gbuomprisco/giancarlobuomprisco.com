<!DOCTYPE html><html lang="en"><head><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/favicon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/favicon.png" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="msapplication-TileColor" content="#000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><meta name="author" content="Giancarlo Buomprisco"/><meta property="og:title" content="Giancarlo Buomprisco"/><meta name="description" content="Giancarlo Buomprisco&#x27;s Website"/><meta property="og:description" content="Giancarlo Buomprisco&#x27;s Website"/><meta property="og:site_name" content="giancarlobuomprisco.com"/><meta property="twitter:title" content="giancarlobuomprisco.com"/><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:creator" content="@gc_psk"/><title>Principles for creating libraries with Nx and Angular</title><meta property="twitter:title" content="Principles for creating libraries with Nx and Angular"/><meta property="og:description"/><meta property="article:published_time" content="2021-02-07T00:00:00.322Z"/><meta property="og:image" content="/assets/images/posts/organize-nx-modules-ngrx.webp"/><meta name="next-head-count" content="27"/><link rel="preload" href="/_next/static/css/1a1796dff5c3b666.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1a1796dff5c3b666.css" data-n-g=""/><link rel="preload" href="/_next/static/css/92b534adac692869.css" as="style"/><link rel="stylesheet" href="/_next/static/css/92b534adac692869.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-27593bf8d60abcde.js" defer=""></script><script src="/_next/static/chunks/framework-93dc06fa7fcdddfb.js" defer=""></script><script src="/_next/static/chunks/main-ee2aed86ad5514de.js" defer=""></script><script src="/_next/static/chunks/pages/_app-64e11a95ea9f54b9.js" defer=""></script><script src="/_next/static/chunks/501-5650b991910e93a7.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bcollection%5D/%5Bslug%5D-afbfecad4873b1f5.js" defer=""></script><script src="/_next/static/w3VqkcZOc77ZlnNKtsX_i/_buildManifest.js" defer=""></script><script src="/_next/static/w3VqkcZOc77ZlnNKtsX_i/_ssgManifest.js" defer=""></script><script src="/_next/static/w3VqkcZOc77ZlnNKtsX_i/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400;600&display=swap">@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNTFM.woff) format('woff')}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFoWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFMWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFsWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFQWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFgWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFkWaDq8fMVxMw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Noto Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/notoserif/v16/ga6Iaw1J5X9T9RW6j9bNfFcWaDq8fMU.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuI6fMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v3/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div><main><div style="--from:#dd0031b0;--to:#dd0031" class="collection-branding-bar_gradient__1Ie5x"></div><div class="container mx-auto px-5"><div class="flex-row flex justify-between my-8 md:my-12"><h2 class="font-normal tracking-tight md:tracking-tighter leading-tight"><a class="hover:underline" href="/"><b>GIANCARLO</b>BUOMPRISCO</a></h2><div><ul class="flex space-x-8 px-4"><li class="text-gray-700 hover:text-gray-900"><a href="/about">About Me</a></li></ul></div></div><article class="mb-32"><h1 class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter md:leading-none mb-8 text-center">Principles for creating libraries with Nx and Angular</h1><div class="mb-4 flex justify-center"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:24px;height:24px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div><div class="max-w-2xl mx-auto mb-6"><div class="flex flex-row space-x-2 items-center justify-center"><div class="text-sm text-center text-gray-600"><time dateTime="2021-02-07T00:00:00.322Z">February	7, 2021</time></div><span class="text-gray-500">·</span><span class="text-gray-500 text-sm">5 min read</span></div></div><div class="mb-8 md:mb-16 sm:mx-0"><div class="w-12/12 md:w-8/12 mx-auto flex justify-center"><div class="sm:mx-0"><img src="/assets/images/posts/organize-nx-modules-ngrx.webp" alt="Cover Image for Principles for creating libraries with Nx and Angular" loading="lazy" class="shadow-small object-contain w-full h-auto"/></div></div></div><div class="max-w-2xl mx-auto leading-loose"><div class="markdown-styles_markdown__1x9gM"><p>If you've worked with both Nx at least once, you probably know it's quite complex to figure out the best way to organize your code into modules a scalable way, and that makes sense.</p>
<p>When you're adding some additional code, have you ever thought about where to add it?</p>
<ul>
<li>An app?</li>
<li>A new module within an app?</li>
<li>The library where it's used?</li>
<li>Maybe a separate library?</li>
</ul>
<p>Yeah - I've been there too.</p>
<p>After lots of trial and error, I've settled on a way that seems clean, and that plays nicely
with the Nx philosophy - but that can only work by following other principles.</p>
<p>This is still very much a work in progress and may change in the future, but in this article, I want to lay down some principles I follow (and intend to test further) when creating Nx libraries. I will try to dig deeper into each of these and describe them with clearer and more specific details.</p>
<h2>Why do we use Nx to separate code into libraries?</h2>
<p>This is the first point to consider: why are we using Nx to split our code into different libraries in the first place?</p>
<p>There are multiple reasons, but here are some that come to mind:</p>
<ul>
<li>I want to be able to reuse code across applications</li>
<li>I want each library to be a unit of the platform which is developed, changed and tested individually</li>
<li>I want to restrict the code my applications are allowed to know or use</li>
</ul>
<p>Nx also provides smart and efficient caching, which means we do not need to rebuild or re-test stuff that hasn't changed, but this is not of interest given this article's scope.</p>
<h3>Principle 1: Splitting by Responsibility</h3>
<p>I usually follow the Module type approach - but I apply it at the library-level. With the fact the Angular modules <em>may</em> go one day, I feel this is also the most future-proof way to think about it.</p>
<p>For example, I don't recommend writing your State Management and any UI components code within the same library. A State Management library is a Services Module and should not contain any declarations.</p>
<p>Indeed, the scope of the State Management library is to manipulate and handle the state of a particular slice of the store. By separating the two, we can build and test them independently and swap the implementations if necessary.</p>
<p>You will also want to access state from different parts of the application (or from multiple applications), and you don't want to bring needless declarations with you along the way.</p>
<p>Let's assume your company is an enterprise that makes software for writing Tasks (yet another!). What could your libraries look like?</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// state management</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TasksStateModule<span class="token punctuation">,</span> TasksStateService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@enterprise/tasks/state'</span><span class="token punctuation">;</span>

<span class="token comment">// DTOs - these are very likely shared with your API!</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateTaskDto<span class="token punctuation">,</span> DeleteTaskDto<span class="token punctuation">,</span> UpdateTaskDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@enterprise/tasks/dto'</span><span class="token punctuation">;</span>

<span class="token comment">// Domain</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Task <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@enterprise/tasks/domain'</span><span class="token punctuation">;</span>

<span class="token comment">// API</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TasksApiModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@enterprise/tasks/api'</span><span class="token punctuation">;</span>

<span class="token comment">// common UI components and containers</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TasksUiModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@enterprise/tasks/ui'</span><span class="token punctuation">;</span>

<span class="token comment">// Tasks Page / Routed Component</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TasksPageModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@enterprise/tasks/page'</span><span class="token punctuation">;</span>

<span class="token comment">// routing (rarely needed, only use for overly complex configurations)</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TasksPageRoutingModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@enterprise/tasks/routing'</span><span class="token punctuation">;</span>

<span class="token comment">// specific features of the domain, mostly UI components, services tha facilitate their work</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateTaskFeatureModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@enterprise/tasks/features/create-task'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> DeleteTaskFeatureModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@enterprise/tasks/features/delete-task'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NewTaskFormFeatureModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@enterprise/tasks/features/new-task-form'</span><span class="token punctuation">;</span>
</code></pre></div>
<p>The above should give you a good idea of this approach to a decently sized enterprise application.</p>
<p>You may want to initialize and handle state related to "tasks" even outside the "Tasks page". This is why it's useful to separate the business domain from the UI components.</p>
<p>If you're wondering how to create sub-libraries, you can use the "directory" parameter when creating a library:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">nx generate library ui --directory tasks</code></pre></div>
<h3>Principle 2: libraries should limit the number of exported entities</h3>
<p>For example, in the case of a state library, only export state-related entities. That is <em>mostly actions and selectors</em>, or a Facade service that hides actions and events from the consumer if you're using one.</p>
<p>If you're finding yourself exporting any other entity, such as a client service, an interface (that is not the state), they can likely be placed in another common library, because chances are, these may be used elsewhere.</p>
<p>This suggests your library <em>may</em> be containing more than it should.</p>
<div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// index.ts</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> TasksStateModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./tasks-state.module'</span><span class="token punctuation">;</span>

<span class="token comment">// consumers can interact and retrieve the state using the Facade</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> TasksFacadeService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./services/tasks-facade.service'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> MockTasksFacadeService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./services/mock-tasks-facade.service'</span><span class="token punctuation">;</span>
</code></pre></div>
<h3>Principle 3: Libraries should change for one reason and one only</h3>
<p>We can apply the Single Responsibility Principle to Nx libraries: if a library changes for multiple reasons, then it could (should?) be split.</p>
<p>This is nothing new, and it's well-described in <em>Clean Architecture</em> by Uncle Bob. With that said - it's also really hard to do well in practical terms.</p>
<p>What exactly is a single "reason"? This is a pretty tricky question you should answer when architecting a library.</p>
<p>What does your library do?</p>
<ul>
<li>Does it define the logic of a particular domain of your application(s)?</li>
<li>Does it define a set of reusable UI components?</li>
<li>Does it define a set of specific components related to the business domain?</li>
</ul>
<p>If there is an "and" somewhere in your answer, then it's an indicator that you should separate the functionalities into another library.</p>
<h3>Final Words</h3>
<p>Nx is relatively new, and while I've seen many projects which approached it pretty well, I still have not seen one that I was entirely satisfied with.</p>
<p>I have personally made loads of mistakes with it - it's really not as easy as it seems to lay down a perfect architecture for complex applications.</p>
<p>As this is still something I'm trying to completely figure out, I cannot 100% recommend you follow it. If you enjoyed it, please do shoot me an email and let me know what you think of it.</p>
<hr>
<p><em>If you enjoyed this article, follow me on <a href="https://twitter.com/gc_psk">Twitter</a></em></p>
</div></div></article><div class="w-full md:w-8/12 mx-auto"><script async="" data-uid="3e3126f064" src="https://thoughtful-inventor-7842.ck.page/3e3126f064/index.js"></script></div><div><hr class="border-accent-2 mt-16 mb-14"/><h3 class="text-2xl md:text-3xl text-center font-semibold my-4 md:my-12 flex flex-row space-x-4 items-center justify-center"><span>More Posts for</span> <div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:28px;height:28px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></h3><section><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 md:gap-x-12 lg:gap-x-16 gap-y-20 md:gap-y-24 mb-32"><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Benchmarking Angular 12 with Webpack 5" href="/angular/webpack-5-angular12"><img src="/assets/images/posts/benchmarking-webpack-5.webp" alt="Cover Image for Benchmarking Angular 12 with Webpack 5" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/webpack-5-angular12">Benchmarking Angular 12 with Webpack 5</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-500"><time dateTime="2021-05-14T00:00:00.322Z">May	14, 2021</time></div><span class="text-gray-500">·</span><span class="text-gray-500">2 min read</span><span class="text-gray-500">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Angular 12 has been released and with it the much awaited Webpack 5 upgrade. In this post I benchmarked the bundle-size and compilation speed against the previous version</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Where to put your Angular models?" href="/angular/angular-where-to-put-models"><img src="/assets/images/posts/where-put-angular-models.webp" alt="Cover Image for Where to put your Angular models?" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/angular-where-to-put-models">Where to put your Angular models?</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-500"><time dateTime="2020-08-03T00:00:00.322Z">August	3, 2020</time></div><span class="text-gray-500">·</span><span class="text-gray-500">3 min read</span><span class="text-gray-500">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Organizing entities and models in your Angular app may be hard. This article explains where to put your entities and what mistakes to watch out for</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Using the Intersection Observer API with Angular" href="/angular/intersection-observer-with-angular"><img src="/assets/images/posts/intersection-observer.webp" alt="Cover Image for Using the Intersection Observer API with Angular" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/intersection-observer-with-angular">Using the Intersection Observer API with Angular</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-500"><time dateTime="2020-08-01T00:00:00.322Z">August	1, 2020</time></div><span class="text-gray-500">·</span><span class="text-gray-500">5 min read</span><span class="text-gray-500">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">This article shows how to build a directive with Angular that uses the Intersection Observer API to check when an element becomes visible on the page</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Setters vs ngOnChanges: which one is better?" href="/angular/setters-vs-ng-on-changes"><img src="/assets/images/posts/setters-vs-on-changes.webp" alt="Cover Image for Setters vs ngOnChanges: which one is better?" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/setters-vs-ng-on-changes">Setters vs ngOnChanges: which one is better?</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-500"><time dateTime="2020-07-30T00:00:00.322Z">July	30, 2020</time></div><span class="text-gray-500">·</span><span class="text-gray-500">3 min read</span><span class="text-gray-500">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Listening to Input changes can be done in different ways. But which one should you use?</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Async Rendering with a single Rx Operator" href="/angular/async-rendering-with-a-single-rx-operator"><img src="/assets/images/posts/async-rendering.webp" alt="Cover Image for Async Rendering with a single Rx Operator" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/async-rendering-with-a-single-rx-operator">Async Rendering with a single Rx Operator</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-500"><time dateTime="2020-07-11T00:00:00.322Z">July	11, 2020</time></div><span class="text-gray-500">·</span><span class="text-gray-500">3 min read</span><span class="text-gray-500">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Increase your app rendering performance with this simple Rx operator</p></div><div><div class="mb-3"><div class="sm:mx-0"><a aria-label="Building Scalable Multi-Platform Projects with Angular and Nx" href="/angular/building-scalable-multi-platform-projects-with-angular-and-nx"><img src="https://cdn-images-1.medium.com/max/1600/0*erZf_hQ4V3MLHSyf" alt="Cover Image for Building Scalable Multi-Platform Projects with Angular and Nx" loading="lazy" class="shadow-small object-contain w-full h-auto hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/building-scalable-multi-platform-projects-with-angular-and-nx">Building Scalable Multi-Platform Projects with Angular and Nx</a></h3><div class="text-xs mb-2 flex flex-row space-x-2 items-center"><div class="text-gray-500"><time dateTime="2019-08-25T00:00:00.322Z">August	25, 2019</time></div><span class="text-gray-500">·</span><span class="text-gray-500">9 min read</span><span class="text-gray-500">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular"><img style="width:16px;height:16px" src="/assets/images/collections/angular.png" alt="angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 text-sm">Building a scalable multi-platform monorepo application with Angular and Nx</p></div></div></section></div></div></main></div><footer><div class="container mx-auto px-5"><hr class="border-accent-2 mt-16 mb-14"/><div class="flex-row flex justify-between my-8 md:my-12"><h2 class="font-normal tracking-tight md:tracking-tighter leading-tight"><a class="hover:underline" href="/"><b>GIANCARLO</b>BUOMPRISCO</a></h2><div><ul class="flex space-x-8 px-4"><li class="text-gray-700 hover:text-gray-900"><a href="/about">About Me</a></li></ul></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"readingTime":"5 min read","title":"Principles for creating libraries with Nx and Angular","date":"2021-02-07T00:00:00.322Z","slug":"how-to-organize-nx-modules-with-angular","content":"\u003cp\u003eIf you've worked with both Nx at least once, you probably know it's quite complex to figure out the best way to organize your code into modules a scalable way, and that makes sense.\u003c/p\u003e\n\u003cp\u003eWhen you're adding some additional code, have you ever thought about where to add it?\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAn app?\u003c/li\u003e\n\u003cli\u003eA new module within an app?\u003c/li\u003e\n\u003cli\u003eThe library where it's used?\u003c/li\u003e\n\u003cli\u003eMaybe a separate library?\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eYeah - I've been there too.\u003c/p\u003e\n\u003cp\u003eAfter lots of trial and error, I've settled on a way that seems clean, and that plays nicely\nwith the Nx philosophy - but that can only work by following other principles.\u003c/p\u003e\n\u003cp\u003eThis is still very much a work in progress and may change in the future, but in this article, I want to lay down some principles I follow (and intend to test further) when creating Nx libraries. I will try to dig deeper into each of these and describe them with clearer and more specific details.\u003c/p\u003e\n\u003ch2\u003eWhy do we use Nx to separate code into libraries?\u003c/h2\u003e\n\u003cp\u003eThis is the first point to consider: why are we using Nx to split our code into different libraries in the first place?\u003c/p\u003e\n\u003cp\u003eThere are multiple reasons, but here are some that come to mind:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eI want to be able to reuse code across applications\u003c/li\u003e\n\u003cli\u003eI want each library to be a unit of the platform which is developed, changed and tested individually\u003c/li\u003e\n\u003cli\u003eI want to restrict the code my applications are allowed to know or use\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNx also provides smart and efficient caching, which means we do not need to rebuild or re-test stuff that hasn't changed, but this is not of interest given this article's scope.\u003c/p\u003e\n\u003ch3\u003ePrinciple 1: Splitting by Responsibility\u003c/h3\u003e\n\u003cp\u003eI usually follow the Module type approach - but I apply it at the library-level. With the fact the Angular modules \u003cem\u003emay\u003c/em\u003e go one day, I feel this is also the most future-proof way to think about it.\u003c/p\u003e\n\u003cp\u003eFor example, I don't recommend writing your State Management and any UI components code within the same library. A State Management library is a Services Module and should not contain any declarations.\u003c/p\u003e\n\u003cp\u003eIndeed, the scope of the State Management library is to manipulate and handle the state of a particular slice of the store. By separating the two, we can build and test them independently and swap the implementations if necessary.\u003c/p\u003e\n\u003cp\u003eYou will also want to access state from different parts of the application (or from multiple applications), and you don't want to bring needless declarations with you along the way.\u003c/p\u003e\n\u003cp\u003eLet's assume your company is an enterprise that makes software for writing Tasks (yet another!). What could your libraries look like?\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token comment\"\u003e// state management\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e TasksStateModule\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e TasksStateService \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@enterprise/tasks/state'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// DTOs - these are very likely shared with your API!\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e CreateTaskDto\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e DeleteTaskDto\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e UpdateTaskDto \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@enterprise/tasks/dto'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Domain\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e Task \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@enterprise/tasks/domain'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// API\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e TasksApiModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@enterprise/tasks/api'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// common UI components and containers\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e TasksUiModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@enterprise/tasks/ui'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Tasks Page / Routed Component\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e TasksPageModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@enterprise/tasks/page'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// routing (rarely needed, only use for overly complex configurations)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e TasksPageRoutingModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@enterprise/tasks/routing'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// specific features of the domain, mostly UI components, services tha facilitate their work\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e CreateTaskFeatureModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@enterprise/tasks/features/create-task'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e DeleteTaskFeatureModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@enterprise/tasks/features/delete-task'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e NewTaskFormFeatureModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@enterprise/tasks/features/new-task-form'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe above should give you a good idea of this approach to a decently sized enterprise application.\u003c/p\u003e\n\u003cp\u003eYou may want to initialize and handle state related to \"tasks\" even outside the \"Tasks page\". This is why it's useful to separate the business domain from the UI components.\u003c/p\u003e\n\u003cp\u003eIf you're wondering how to create sub-libraries, you can use the \"directory\" parameter when creating a library:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003enx generate library ui --directory tasks\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003ePrinciple 2: libraries should limit the number of exported entities\u003c/h3\u003e\n\u003cp\u003eFor example, in the case of a state library, only export state-related entities. That is \u003cem\u003emostly actions and selectors\u003c/em\u003e, or a Facade service that hides actions and events from the consumer if you're using one.\u003c/p\u003e\n\u003cp\u003eIf you're finding yourself exporting any other entity, such as a client service, an interface (that is not the state), they can likely be placed in another common library, because chances are, these may be used elsewhere.\u003c/p\u003e\n\u003cp\u003eThis suggests your library \u003cem\u003emay\u003c/em\u003e be containing more than it should.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token comment\"\u003e// index.ts\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e TasksStateModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./tasks-state.module'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// consumers can interact and retrieve the state using the Facade\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e TasksFacadeService \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./services/tasks-facade.service'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e MockTasksFacadeService \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./services/mock-tasks-facade.service'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003ePrinciple 3: Libraries should change for one reason and one only\u003c/h3\u003e\n\u003cp\u003eWe can apply the Single Responsibility Principle to Nx libraries: if a library changes for multiple reasons, then it could (should?) be split.\u003c/p\u003e\n\u003cp\u003eThis is nothing new, and it's well-described in \u003cem\u003eClean Architecture\u003c/em\u003e by Uncle Bob. With that said - it's also really hard to do well in practical terms.\u003c/p\u003e\n\u003cp\u003eWhat exactly is a single \"reason\"? This is a pretty tricky question you should answer when architecting a library.\u003c/p\u003e\n\u003cp\u003eWhat does your library do?\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDoes it define the logic of a particular domain of your application(s)?\u003c/li\u003e\n\u003cli\u003eDoes it define a set of reusable UI components?\u003c/li\u003e\n\u003cli\u003eDoes it define a set of specific components related to the business domain?\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf there is an \"and\" somewhere in your answer, then it's an indicator that you should separate the functionalities into another library.\u003c/p\u003e\n\u003ch3\u003eFinal Words\u003c/h3\u003e\n\u003cp\u003eNx is relatively new, and while I've seen many projects which approached it pretty well, I still have not seen one that I was entirely satisfied with.\u003c/p\u003e\n\u003cp\u003eI have personally made loads of mistakes with it - it's really not as easy as it seems to lay down a perfect architecture for complex applications.\u003c/p\u003e\n\u003cp\u003eAs this is still something I'm trying to completely figure out, I cannot 100% recommend you follow it. If you enjoyed it, please do shoot me an email and let me know what you think of it.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cem\u003eIf you enjoyed this article, follow me on \u003ca href=\"https://twitter.com/gc_psk\"\u003eTwitter\u003c/a\u003e\u003c/em\u003e\u003c/p\u003e\n","coverImage":"/assets/images/posts/organize-nx-modules-ngrx.webp","collection":"angular"},"morePosts":[{"readingTime":"2 min read","title":"Benchmarking Angular 12 with Webpack 5","date":"2021-05-14T00:00:00.322Z","slug":"webpack-5-angular12","coverImage":"/assets/images/posts/benchmarking-webpack-5.webp","collection":"angular","excerpt":"Angular 12 has been released and with it the much awaited Webpack 5 upgrade. In this post I benchmarked the bundle-size and compilation speed against the previous version"},{"readingTime":"3 min read","title":"Where to put your Angular models?","date":"2020-08-03T00:00:00.322Z","slug":"angular-where-to-put-models","ogImage":{"url":"/assets/images/posts/where-put-angular-models.png"},"coverImage":"/assets/images/posts/where-put-angular-models.webp","collection":"angular","excerpt":"Organizing entities and models in your Angular app may be hard. This article explains where to put your entities and what mistakes to watch out for"},{"readingTime":"5 min read","title":"Using the Intersection Observer API with Angular","date":"2020-08-01T00:00:00.322Z","slug":"intersection-observer-with-angular","coverImage":"/assets/images/posts/intersection-observer.webp","collection":"angular","excerpt":"This article shows how to build a directive with Angular that uses the Intersection Observer API to check when an element becomes visible on the page"},{"readingTime":"3 min read","title":"Setters vs ngOnChanges: which one is better?","date":"2020-07-30T00:00:00.322Z","slug":"setters-vs-ng-on-changes","coverImage":"/assets/images/posts/setters-vs-on-changes.webp","collection":"angular","excerpt":"Listening to Input changes can be done in different ways. But which one should you use?"},{"readingTime":"3 min read","title":"Async Rendering with a single Rx Operator","date":"2020-07-11T00:00:00.322Z","slug":"async-rendering-with-a-single-rx-operator","coverImage":"/assets/images/posts/async-rendering.webp","collection":"angular","excerpt":"Increase your app rendering performance with this simple Rx operator"},{"readingTime":"9 min read","title":"Building Scalable Multi-Platform Projects with Angular and Nx","date":"2019-08-25T00:00:00.322Z","slug":"building-scalable-multi-platform-projects-with-angular-and-nx","ogImage":{"url":"https://cdn-images-1.medium.com/max/1600/0*erZf_hQ4V3MLHSyf"},"coverImage":"https://cdn-images-1.medium.com/max/1600/0*erZf_hQ4V3MLHSyf","collection":"angular","excerpt":"Building a scalable multi-platform monorepo application with Angular and Nx"}]},"__N_SSG":true},"page":"/[collection]/[slug]","query":{"collection":"angular","slug":"how-to-organize-nx-modules-with-angular"},"buildId":"w3VqkcZOc77ZlnNKtsX_i","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-172483071-1"></script><script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-172483071-1');
</script></body></html>