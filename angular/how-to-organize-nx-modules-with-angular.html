<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&amp;family=Merriweather:wght@300;400;700&amp;display=swap"/><link rel="canonical" href="https://giancarlobuomprisco.com/angular/how-to-organize-nx-modules-with-angular"/><meta name="theme-color" content="#212121"/><meta name="author" content="Giancarlo Buomprisco"/><meta property="og:site_name" content="giancarlobuomprisco.com"/><meta property="twitter:creator" content="@gc_psk"/><meta property="twitter:card" content="summary_large_image"/><title>Principles for creating libraries with Nx and Angular</title><meta property="og:type" content="article"/><meta property="og:title" content="Principles for creating libraries with Nx and Angular"/><meta property="article:published_time" content="2021-02-07T00:00:00.322Z"/><meta property="twitter:title" content="Principles for creating libraries with Nx and Angular"/><meta property="twitter:description" content="Working with Nx may be confusing. This article explains how I create Nx libraries and the principles behind my motivations"/><meta property="twitter:image" content="https://giancarlobuomprisco.com/assets/images/posts/organize-nx-modules-ngrx.webp"/><meta property="og:description" content="Working with Nx may be confusing. This article explains how I create Nx libraries and the principles behind my motivations"/><meta name="description" content="Working with Nx may be confusing. This article explains how I create Nx libraries and the principles behind my motivations"/><meta property="og:image" content="https://giancarlobuomprisco.com/assets/images/posts/organize-nx-modules-ngrx.webp"/><script type="application/ld+json">{&quot;@context&quot;:&quot;https://schema.org/&quot;,&quot;@type&quot;:&quot;Article&quot;,&quot;mainEntityOfPage&quot;:{&quot;@type&quot;:&quot;WebPage&quot;,&quot;@id&quot;:&quot;https://google.com/article&quot;},&quot;image&quot;:[&quot;https://giancarlobuomprisco.com/assets/images/posts/organize-nx-modules-ngrx.webp&quot;],&quot;headline&quot;:&quot;Principles for creating libraries with Nx and Angular&quot;,&quot;description&quot;:&quot;Working with Nx may be confusing. This article explains how I create Nx libraries and the principles behind my motivations&quot;,&quot;author&quot;:{&quot;@type&quot;:&quot;Person&quot;,&quot;name&quot;:&quot;Giancarlo Buomprisco&quot;,&quot;url&quot;:&quot;https://twitter.com/@gc_psk&quot;},&quot;datePublished&quot;:&quot;2021-02-07T00:00:00.322Z&quot;}</script><meta name="next-head-count" content="28"/><link rel="preload" href="/_next/static/css/34373a9c999378cf.css" as="style"/><link rel="stylesheet" href="/_next/static/css/34373a9c999378cf.css" data-n-g=""/><link rel="preload" href="/_next/static/css/0872225b3e11ef97.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0872225b3e11ef97.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-27593bf8d60abcde.js" defer=""></script><script src="/_next/static/chunks/framework-93dc06fa7fcdddfb.js" defer=""></script><script src="/_next/static/chunks/main-e47b4831833660b7.js" defer=""></script><script src="/_next/static/chunks/pages/_app-8ff1c8d9702d8e84.js" defer=""></script><script src="/_next/static/chunks/501-5650b991910e93a7.js" defer=""></script><script src="/_next/static/chunks/506-f1e1733ed0e3b9a9.js" defer=""></script><script src="/_next/static/chunks/176-272b3cbb63989f10.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bcollection%5D/%5Bslug%5D-a70601baec9b1eb7.js" defer=""></script><script src="/_next/static/LMv2Q51Igj6ta-9H8i7xA/_buildManifest.js" defer=""></script><script src="/_next/static/LMv2Q51Igj6ta-9H8i7xA/_ssgManifest.js" defer=""></script><script src="/_next/static/LMv2Q51Igj6ta-9H8i7xA/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div><main><div style="--accent:#e23236;--accent-light:#e23236;--accent-contrast:#ffffff"><div style="--from:#dd00316e;--to:#e23236" class="collection-branding-bar_gradient__1Ie5x"></div><div class="container mx-auto px-5"><div class="flex-row flex justify-between items-center py-2 mt-6 mb-8"><a class="hover:underline" href="/"><b>GIANCARLO</b><span>BUOMPRISCO</span></a><div class="justify-end lg:hidden flex"><button aria-label="Open Menu" class="navbar-burger" type="button"><span class="block relative w-7 rounded-sm bg-black h-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span></button></div><ul class="lg:space-x-10 text-gray-800 px-4 hidden flex-col space-y-4 lg:space-y-0 lg:flex lg:flex-row nav"><li class="flex flex-row justify-between mb-6 lg:hidden"><div><a class="hover:underline" href="/"><b>GIANCARLO</b><span>BUOMPRISCO</span></a></div><div class="flex justify-end"><span class="bg-gray-100 font-bold text-sm rounded-full shadow-xl flex items-center justify-center w-16 h-16">Close</span></div></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/blog">Blog</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/articles">Articles</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/consulting">Consulting</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/about">About</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/contact">Contact me</a></li></ul></div><article class="mb-16"><h1 class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter md:leading-none mb-8 text-center">Principles for creating libraries with Nx and Angular</h1><div class="mb-6 flex space-x-3 items-center justify-center"><div style="--backgroundColor:#e23236;--color:#ffffff" class="text-center flex flex-row space-x-1 items-center cursor-pointer justify-center px-2 py-1 rounded hover:shadow-md transition-shadow font-bold tag_Tag__tPe2P"><a class="flex flex-row space-x-1 items-center justify-center" href="/angular"><img class="object-contain" loading="lazy" style="width:22px;height:22px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></a></div><div style="--backgroundColor:#eee" class="text-center flex flex-row space-x-1 items-center cursor-pointer justify-center px-2 py-1 rounded hover:shadow-md transition-shadow font-bold tag_Tag__tPe2P"><a href="/tags/nx">nx</a></div></div><div class="max-w-2xl mx-auto mb-6"><div class="flex flex-row space-x-2 items-center justify-center"><div class="flex flex-row space-x-3 items-center"><a target="_blank" rel="noreferrer noopened" href="https://twitter.com/@gc_psk"><img width="45px" height="45px" src="/assets/giancarlo-2.png"/></a><a class="text-sm text-gray-600" target="_blank" rel="noreferrer noopened" href="https://twitter.com/@gc_psk">@gc_psk</a></div><span class="text-gray-600">·</span><div class="text-sm text-center text-gray-600"><time dateTime="2021-02-07T00:00:00.322Z">Feb 7, 2021</time></div><span class="text-gray-600">·</span><span class="text-gray-600 text-sm">5 min read</span></div></div><div class="mb-8 md:mb-16 sm:mx-0"><div class="mx-auto w-12/12 lg:w-10/12 xl:w-8/12 justify-center"><div class="sm:mx-0"><img style="width:100%;height:auto" class="block shadow-xl rounded-md" src="/assets/images/posts/organize-nx-modules-ngrx.webp" alt="Cover Image for Principles for creating libraries with Nx and Angular" loading="lazy"/></div></div></div><div class="mb-12 max-w-2xl mx-auto"></div><div class="max-w-2xl mx-auto leading-loose markdown-styles_markdown__1x9gM"><p>If you&#x27;ve worked with both Nx at least once, you probably know it&#x27;s quite complex to figure out the best way to organize your code into modules a scalable way, and that makes sense.</p><p>When you&#x27;re adding some additional code, have you ever thought about where to add it?</p><ul><li>An app?</li><li>A new module within an app?</li><li>The library where it&#x27;s used?</li><li>Maybe a separate library?</li></ul><p>Yeah - I&#x27;ve been there too.</p><p>After lots of trial and error, I&#x27;ve settled on a way that seems clean, and that plays nicely
with the Nx philosophy - but that can only work by following other principles.</p><p>This is still very much a work in progress and may change in the future, but in this article, I want to lay down some principles I follow (and intend to test further) when creating Nx libraries. I will try to dig deeper into each of these and describe them with clearer and more specific details.</p><h2>Why do we use Nx to separate code into libraries?</h2><p>This is the first point to consider: why are we using Nx to split our code into different libraries in the first place?</p><p>There are multiple reasons, but here are some that come to mind:</p><ul><li>I want to be able to reuse code across applications</li><li>I want each library to be a unit of the platform which is developed, changed and tested individually</li><li>I want to restrict the code my applications are allowed to know or use</li></ul><p>Nx also provides smart and efficient caching, which means we do not need to rebuild or re-test stuff that hasn&#x27;t changed, but this is not of interest given this article&#x27;s scope.</p><h3>Principle 1: Splitting by Responsibility</h3><p>I usually follow the Module type approach - but I apply it at the library-level. With the fact the Angular modules <em>may</em> go one day, I feel this is also the most future-proof way to think about it.</p><p>For example, I don&#x27;t recommend writing your State Management and any UI components code within the same library. A State Management library is a Services Module and should not contain any declarations.</p><p>Indeed, the scope of the State Management library is to manipulate and handle the state of a particular slice of the store. By separating the two, we can build and test them independently and swap the implementations if necessary.</p><p>You will also want to access state from different parts of the application (or from multiple applications), and you don&#x27;t want to bring needless declarations with you along the way.</p><p>Let&#x27;s assume your company is an enterprise that makes software for writing Tasks (yet another!). What could your libraries look like?</p><div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// state management</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TasksStateModule<span class="token punctuation">,</span> TasksStateService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@enterprise/tasks/state&#x27;</span><span class="token punctuation">;</span>

<span class="token comment">// DTOs - these are very likely shared with your API!</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateTaskDto<span class="token punctuation">,</span> DeleteTaskDto<span class="token punctuation">,</span> UpdateTaskDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@enterprise/tasks/dto&#x27;</span><span class="token punctuation">;</span>

<span class="token comment">// Domain</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Task <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@enterprise/tasks/domain&#x27;</span><span class="token punctuation">;</span>

<span class="token comment">// API</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TasksApiModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@enterprise/tasks/api&#x27;</span><span class="token punctuation">;</span>

<span class="token comment">// common UI components and containers</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TasksUiModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@enterprise/tasks/ui&#x27;</span><span class="token punctuation">;</span>

<span class="token comment">// Tasks Page / Routed Component</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TasksPageModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@enterprise/tasks/page&#x27;</span><span class="token punctuation">;</span>

<span class="token comment">// routing (rarely needed, only use for overly complex configurations)</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TasksPageRoutingModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@enterprise/tasks/routing&#x27;</span><span class="token punctuation">;</span>

<span class="token comment">// specific features of the domain, mostly UI components, services tha facilitate their work</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateTaskFeatureModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@enterprise/tasks/features/create-task&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> DeleteTaskFeatureModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@enterprise/tasks/features/delete-task&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NewTaskFormFeatureModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@enterprise/tasks/features/new-task-form&#x27;</span><span class="token punctuation">;</span>
</code></pre></div><p>The above should give you a good idea of this approach to a decently sized enterprise application.</p><p>You may want to initialize and handle state related to &quot;tasks&quot; even outside the &quot;Tasks page&quot;. This is why it&#x27;s useful to separate the business domain from the UI components.</p><p>If you&#x27;re wondering how to create sub-libraries, you can use the &quot;directory&quot; parameter when creating a library:</p><div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">nx generate library ui --directory tasks</code></pre></div><h3>Principle 2: libraries should limit the number of exported entities</h3><p>For example, in the case of a state library, only export state-related entities. That is <em>mostly actions and selectors</em>, or a Facade service that hides actions and events from the consumer if you&#x27;re using one.</p><p>If you&#x27;re finding yourself exporting any other entity, such as a client service, an interface (that is not the state), they can likely be placed in another common library, because chances are, these may be used elsewhere.</p><p>This suggests your library <em>may</em> be containing more than it should.</p><div class="remark-highlight"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// index.ts</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> TasksStateModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;./tasks-state.module&#x27;</span><span class="token punctuation">;</span>

<span class="token comment">// consumers can interact and retrieve the state using the Facade</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> TasksFacadeService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;./services/tasks-facade.service&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> MockTasksFacadeService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;./services/mock-tasks-facade.service&#x27;</span><span class="token punctuation">;</span>
</code></pre></div><h3>Principle 3: Libraries should change for one reason and one only</h3><p>We can apply the Single Responsibility Principle to Nx libraries: if a library changes for multiple reasons, then it could (should?) be split.</p><p>This is nothing new, and it&#x27;s well-described in <em>Clean Architecture</em> by Uncle Bob. With that said - it&#x27;s also really hard to do well in practical terms.</p><p>What exactly is a single &quot;reason&quot;? This is a pretty tricky question you should answer when architecting a library.</p><p>What does your library do?</p><ul><li>Does it define the logic of a particular domain of your application(s)?</li><li>Does it define a set of reusable UI components?</li><li>Does it define a set of specific components related to the business domain?</li></ul><p>If there is an &quot;and&quot; somewhere in your answer, then it&#x27;s an indicator that you should separate the functionalities into another library.</p><h3>Final Words</h3><p>Nx is relatively new, and while I&#x27;ve seen many projects which approached it pretty well, I still have not seen one that I was entirely satisfied with.</p><p>I have personally made loads of mistakes with it - it&#x27;s really not as easy as it seems to lay down a perfect architecture for complex applications.</p><p>As this is still something I&#x27;m trying to completely figure out, I cannot 100% recommend you follow it. If you enjoyed it, please do shoot me an email and let me know what you think of it.</p><hr/><p><em>If you enjoyed this article, follow me on <a href="https://twitter.com/gc_psk" target="_blank" rel="noopener noreferrer">Twitter</a></em></p></div></article><div class="max-w-2xl mx-auto"></div><div class="w-full md:w-8/12 mx-auto my-4"><script async="" data-uid="3e3126f064" src="https://thoughtful-inventor-7842.ck.page/3e3126f064/index.js"></script></div><div><hr class="border-accent-2 mt-16 mb-14"/><h3 class="text-2xl md:text-3xl text-center font-semibold my-4 md:my-12 flex flex-row space-x-4 items-center justify-center"><span>Learn more about</span> <div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:28px;height:28px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></h3><section><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 md:gap-x-12 lg:gap-x-14 gap-y-16 md:gap-y-18 mb-32"><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="Benchmarking Angular 12 with Webpack 5" href="/angular/webpack-5-angular12"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="/assets/images/posts/benchmarking-webpack-5.webp" alt="Cover Image for Benchmarking Angular 12 with Webpack 5" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/webpack-5-angular12">Benchmarking Angular 12 with Webpack 5</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2021-05-14T00:00:00.322Z">May 14, 2021</time></div><span class="text-gray-600">·</span><span class="text-gray-600">2 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">Angular 12 has been released and with it the much awaited Webpack 5 upgrade. In this post I benchmarked the bundle-size and compilation speed against the previous version</p></div><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="Where to put your Angular models?" href="/angular/angular-where-to-put-models"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="/assets/images/posts/where-put-angular-models.webp" alt="Cover Image for Where to put your Angular models?" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/angular-where-to-put-models">Where to put your Angular models?</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2020-08-03T00:00:00.322Z">Aug 3, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">Organizing entities and models in your Angular app may be hard. This article explains where to put your entities and what mistakes to watch out for</p></div><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="Using the Intersection Observer API with Angular" href="/angular/intersection-observer-with-angular"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="/assets/images/posts/intersection-observer.webp" alt="Cover Image for Using the Intersection Observer API with Angular" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/intersection-observer-with-angular">Using the Intersection Observer API with Angular</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2020-08-01T00:00:00.322Z">Aug 1, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">5 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">This article shows how to build a directive with Angular that uses the Intersection Observer API to check when an element becomes visible on the page</p></div><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="Setters vs ngOnChanges: which one is better?" href="/angular/setters-vs-ng-on-changes"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="/assets/images/posts/setters-vs-on-changes.webp" alt="Cover Image for Setters vs ngOnChanges: which one is better?" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/setters-vs-ng-on-changes">Setters vs ngOnChanges: which one is better?</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2020-07-30T00:00:00.322Z">Jul 30, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">Listening to Input changes can be done in different ways. But which one should you use?</p></div><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="Async Rendering with a single Rx Operator" href="/angular/async-rendering-with-a-single-rx-operator"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="/assets/images/posts/async-rendering.webp" alt="Cover Image for Async Rendering with a single Rx Operator" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/async-rendering-with-a-single-rx-operator">Async Rendering with a single Rx Operator</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2020-07-11T00:00:00.322Z">Jul 11, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">3 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">Increase your app rendering performance with this simple Rx operator</p></div><div class="shadow-lg rounded-md hover:shadow-xl transition-shadow duration-500"><div class="mb-3"><div class="sm:mx-0"><a aria-label="3 Ways to Render Large Lists in Angular" href="/angular/three-ways-render-large-lists-angular"><img class="block transition-shadow duration-500 h-full w-full lg:h-48 xl:h-48 rounded-t-md" src="https://cdn-images-1.medium.com/max/2560/1*URBd9pgYJGC0vhqthQ-z8g.jpeg" alt="Cover Image for 3 Ways to Render Large Lists in Angular" loading="lazy"/></a></div></div><div class="px-4 py-2"><h3 class="text-2xl font-bold mb-2 leading-snug"><a class="hover:underline" href="/angular/three-ways-render-large-lists-angular">3 Ways to Render Large Lists in Angular</a></h3></div><div class="text-xs mb-4 flex flex-row space-x-2 items-center px-4"><div class="text-gray-600"><time dateTime="2020-05-09T00:00:00.322Z">May 9, 2020</time></div><span class="text-gray-600">·</span><span class="text-gray-600">6 min read</span><span class="text-gray-600">·</span><div class="text-xs"><div class="text-center flex flex-row space-x-1 items-center cursor-pointer collection--angular" href="/angular"><img class="object-contain" loading="lazy" style="width:16px;height:16px" src="/assets/images/collections/angular.webp" alt="Angular"/><span class="hover:underline">Angular</span></div></div></div><p class="leading-relaxed mb-4 px-4 text-sm">An overview of the available techniques to render large lists of items with Angular</p></div></div></section></div></div></div></main></div><footer><div class="container mx-auto px-5"><hr class="border-accent-2 mt-16 mb-14"/><div class="flex-row flex justify-between items-center py-2 mt-6 mb-8"><a class="hover:underline" href="/"><b>GIANCARLO</b><span>BUOMPRISCO</span></a><div class="justify-end lg:hidden flex"><button aria-label="Open Menu" class="navbar-burger" type="button"><span class="block relative w-7 rounded-sm bg-black h-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span><span class="block relative w-7 rounded-sm bg-black h-1 mt-1"></span></button></div><ul class="lg:space-x-10 text-gray-800 px-4 hidden flex-col space-y-4 lg:space-y-0 lg:flex lg:flex-row nav"><li class="flex flex-row justify-between mb-6 lg:hidden"><div><a class="hover:underline" href="/"><b>GIANCARLO</b><span>BUOMPRISCO</span></a></div><div class="flex justify-end"><span class="bg-gray-100 font-bold text-sm rounded-full shadow-xl flex items-center justify-center w-16 h-16">Close</span></div></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/blog">Blog</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/articles">Articles</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/consulting">Consulting</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/about">About</a></li><li class="text-lg lg:text-base border-b-4 pb-1 border-b-transparent transition:border hover:text-gray-900 font-medium border-b-transparent hover:border-b-yellow-200"><a class="block" href="/contact">Contact me</a></li></ul></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"live":true,"readingTime":"5 min read","title":"Principles for creating libraries with Nx and Angular","date":"2021-02-07T00:00:00.322Z","slug":"how-to-organize-nx-modules-with-angular","coverImage":"/assets/images/posts/organize-nx-modules-ngrx.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Working with Nx may be confusing. This article explains how I create Nx libraries and the principles behind my motivations","content":"\nIf you've worked with both Nx at least once, you probably know it's quite complex to figure out the best way to organize your code into modules a scalable way, and that makes sense.\n\nWhen you're adding some additional code, have you ever thought about where to add it?\n\n- An app?\n- A new module within an app?\n- The library where it's used?\n- Maybe a separate library?\n\nYeah - I've been there too.\n\nAfter lots of trial and error, I've settled on a way that seems clean, and that plays nicely\nwith the Nx philosophy - but that can only work by following other principles.\n\nThis is still very much a work in progress and may change in the future, but in this article, I want to lay down some principles I follow (and intend to test further) when creating Nx libraries. I will try to dig deeper into each of these and describe them with clearer and more specific details.\n\n## Why do we use Nx to separate code into libraries?\n\nThis is the first point to consider: why are we using Nx to split our code into different libraries in the first place?\n\nThere are multiple reasons, but here are some that come to mind:\n\n- I want to be able to reuse code across applications\n- I want each library to be a unit of the platform which is developed, changed and tested individually\n- I want to restrict the code my applications are allowed to know or use\n\nNx also provides smart and efficient caching, which means we do not need to rebuild or re-test stuff that hasn't changed, but this is not of interest given this article's scope.\n\n### Principle 1: Splitting by Responsibility\n\nI usually follow the Module type approach - but I apply it at the library-level. With the fact the Angular modules *may* go one day, I feel this is also the most future-proof way to think about it.\n\nFor example, I don't recommend writing your State Management and any UI components code within the same library. A State Management library is a Services Module and should not contain any declarations.\n\nIndeed, the scope of the State Management library is to manipulate and handle the state of a particular slice of the store. By separating the two, we can build and test them independently and swap the implementations if necessary.\n\nYou will also want to access state from different parts of the application (or from multiple applications), and you don't want to bring needless declarations with you along the way.\n\nLet's assume your company is an enterprise that makes software for writing Tasks (yet another!). What could your libraries look like?\n\n```typescript\n// state management\nimport { TasksStateModule, TasksStateService } from '@enterprise/tasks/state';\n\n// DTOs - these are very likely shared with your API!\nimport { CreateTaskDto, DeleteTaskDto, UpdateTaskDto } from '@enterprise/tasks/dto';\n\n// Domain\nimport { Task } from '@enterprise/tasks/domain';\n\n// API\nimport { TasksApiModule } from '@enterprise/tasks/api';\n\n// common UI components and containers\nimport { TasksUiModule } from '@enterprise/tasks/ui';\n\n// Tasks Page / Routed Component\nimport { TasksPageModule } from '@enterprise/tasks/page';\n\n// routing (rarely needed, only use for overly complex configurations)\nimport { TasksPageRoutingModule } from '@enterprise/tasks/routing';\n\n// specific features of the domain, mostly UI components, services tha facilitate their work\nimport { CreateTaskFeatureModule } from '@enterprise/tasks/features/create-task';\nimport { DeleteTaskFeatureModule } from '@enterprise/tasks/features/delete-task';\nimport { NewTaskFormFeatureModule } from '@enterprise/tasks/features/new-task-form';\n```\n\nThe above should give you a good idea of this approach to a decently sized enterprise application.\n\nYou may want to initialize and handle state related to \"tasks\" even outside the \"Tasks page\". This is why it's useful to separate the business domain from the UI components.\n\nIf you're wondering how to create sub-libraries, you can use the \"directory\" parameter when creating a library:\n\n```\nnx generate library ui --directory tasks\n```\n\n### Principle 2: libraries should limit the number of exported entities\n\nFor example, in the case of a state library, only export state-related entities. That is *mostly actions and selectors*, or a Facade service that hides actions and events from the consumer if you're using one.\n\nIf you're finding yourself exporting any other entity, such as a client service, an interface (that is not the state), they can likely be placed in another common library, because chances are, these may be used elsewhere.\n\nThis suggests your library *may* be containing more than it should.\n\n```typescript\n// index.ts\n\nexport { TasksStateModule } from './tasks-state.module';\n\n// consumers can interact and retrieve the state using the Facade\nexport { TasksFacadeService } from './services/tasks-facade.service';\nexport { MockTasksFacadeService } from './services/mock-tasks-facade.service';\n```\n\n### Principle 3: Libraries should change for one reason and one only\n\nWe can apply the Single Responsibility Principle to Nx libraries: if a library changes for multiple reasons, then it could (should?) be split.\n\nThis is nothing new, and it's well-described in *Clean Architecture* by Uncle Bob. With that said - it's also really hard to do well in practical terms.\n\nWhat exactly is a single \"reason\"? This is a pretty tricky question you should answer when architecting a library.\n\nWhat does your library do?\n\n- Does it define the logic of a particular domain of your application(s)?\n- Does it define a set of reusable UI components?\n- Does it define a set of specific components related to the business domain?\n\nIf there is an \"and\" somewhere in your answer, then it's an indicator that you should separate the functionalities into another library.\n\n\n### Final Words\n\nNx is relatively new, and while I've seen many projects which approached it pretty well, I still have not seen one that I was entirely satisfied with.\n\nI have personally made loads of mistakes with it - it's really not as easy as it seems to lay down a perfect architecture for complex applications.\n\nAs this is still something I'm trying to completely figure out, I cannot 100% recommend you follow it. If you enjoyed it, please do shoot me an email and let me know what you think of it.\n\n***\n\n_If you enjoyed this article, follow me on [Twitter](https://twitter.com/gc_psk)_\n","tags":["nx","angular"]},"content":{"compiledSource":"var l=Object.defineProperty,d=Object.defineProperties;var u=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var i=(a,n,t)=\u003en in a?l(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,e=(a,n)=\u003e{for(var t in n||(n={}))p.call(n,t)\u0026\u0026i(a,t,n[t]);if(o)for(var t of o(n))r.call(n,t)\u0026\u0026i(a,t,n[t]);return a},c=(a,n)=\u003ed(a,u(n));var m=(a,n)=\u003e{var t={};for(var s in a)p.call(a,s)\u0026\u0026n.indexOf(s)\u003c0\u0026\u0026(t[s]=a[s]);if(a!=null\u0026\u0026o)for(var s of o(a))n.indexOf(s)\u003c0\u0026\u0026r.call(a,s)\u0026\u0026(t[s]=a[s]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:a}=s,n=m(s,[\"components\"]);return mdx(MDXLayout,c(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(\"p\",null,\"If you've worked with both Nx at least once, you probably know it's quite complex to figure out the best way to organize your code into modules a scalable way, and that makes sense.\"),mdx(\"p\",null,\"When you're adding some additional code, have you ever thought about where to add it?\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"An app?\"),mdx(\"li\",{parentName:\"ul\"},\"A new module within an app?\"),mdx(\"li\",{parentName:\"ul\"},\"The library where it's used?\"),mdx(\"li\",{parentName:\"ul\"},\"Maybe a separate library?\")),mdx(\"p\",null,\"Yeah - I've been there too.\"),mdx(\"p\",null,`After lots of trial and error, I've settled on a way that seems clean, and that plays nicely\nwith the Nx philosophy - but that can only work by following other principles.`),mdx(\"p\",null,\"This is still very much a work in progress and may change in the future, but in this article, I want to lay down some principles I follow (and intend to test further) when creating Nx libraries. I will try to dig deeper into each of these and describe them with clearer and more specific details.\"),mdx(\"h2\",null,\"Why do we use Nx to separate code into libraries?\"),mdx(\"p\",null,\"This is the first point to consider: why are we using Nx to split our code into different libraries in the first place?\"),mdx(\"p\",null,\"There are multiple reasons, but here are some that come to mind:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"I want to be able to reuse code across applications\"),mdx(\"li\",{parentName:\"ul\"},\"I want each library to be a unit of the platform which is developed, changed and tested individually\"),mdx(\"li\",{parentName:\"ul\"},\"I want to restrict the code my applications are allowed to know or use\")),mdx(\"p\",null,\"Nx also provides smart and efficient caching, which means we do not need to rebuild or re-test stuff that hasn't changed, but this is not of interest given this article's scope.\"),mdx(\"h3\",null,\"Principle 1: Splitting by Responsibility\"),mdx(\"p\",null,\"I usually follow the Module type approach - but I apply it at the library-level. With the fact the Angular modules \",mdx(\"em\",{parentName:\"p\"},\"may\"),\" go one day, I feel this is also the most future-proof way to think about it.\"),mdx(\"p\",null,\"For example, I don't recommend writing your State Management and any UI components code within the same library. A State Management library is a Services Module and should not contain any declarations.\"),mdx(\"p\",null,\"Indeed, the scope of the State Management library is to manipulate and handle the state of a particular slice of the store. By separating the two, we can build and test them independently and swap the implementations if necessary.\"),mdx(\"p\",null,\"You will also want to access state from different parts of the application (or from multiple applications), and you don't want to bring needless declarations with you along the way.\"),mdx(\"p\",null,\"Let's assume your company is an enterprise that makes software for writing Tasks (yet another!). What could your libraries look like?\"),mdx(\"div\",e({},{className:\"remark-highlight\"}),mdx(\"pre\",e({parentName:\"div\"},{className:\"language-typescript\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-typescript\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// state management\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" TasksStateModule\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" TasksStateService \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'@enterprise/tasks/state'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// DTOs - these are very likely shared with your API!\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" CreateTaskDto\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" DeleteTaskDto\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" UpdateTaskDto \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'@enterprise/tasks/dto'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// Domain\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" Task \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'@enterprise/tasks/domain'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// API\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" TasksApiModule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'@enterprise/tasks/api'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// common UI components and containers\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" TasksUiModule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'@enterprise/tasks/ui'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// Tasks Page / Routed Component\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" TasksPageModule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'@enterprise/tasks/page'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// routing (rarely needed, only use for overly complex configurations)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" TasksPageRoutingModule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'@enterprise/tasks/routing'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// specific features of the domain, mostly UI components, services tha facilitate their work\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" CreateTaskFeatureModule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'@enterprise/tasks/features/create-task'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" DeleteTaskFeatureModule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'@enterprise/tasks/features/delete-task'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" NewTaskFormFeatureModule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'@enterprise/tasks/features/new-task-form'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n`))),mdx(\"p\",null,\"The above should give you a good idea of this approach to a decently sized enterprise application.\"),mdx(\"p\",null,`You may want to initialize and handle state related to \"tasks\" even outside the \"Tasks page\". This is why it's useful to separate the business domain from the UI components.`),mdx(\"p\",null,`If you're wondering how to create sub-libraries, you can use the \"directory\" parameter when creating a library:`),mdx(\"div\",e({},{className:\"remark-highlight\"}),mdx(\"pre\",e({parentName:\"div\"},{className:\"language-unknown\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-unknown\"}),\"nx generate library ui --directory tasks\"))),mdx(\"h3\",null,\"Principle 2: libraries should limit the number of exported entities\"),mdx(\"p\",null,\"For example, in the case of a state library, only export state-related entities. That is \",mdx(\"em\",{parentName:\"p\"},\"mostly actions and selectors\"),\", or a Facade service that hides actions and events from the consumer if you're using one.\"),mdx(\"p\",null,\"If you're finding yourself exporting any other entity, such as a client service, an interface (that is not the state), they can likely be placed in another common library, because chances are, these may be used elsewhere.\"),mdx(\"p\",null,\"This suggests your library \",mdx(\"em\",{parentName:\"p\"},\"may\"),\" be containing more than it should.\"),mdx(\"div\",e({},{className:\"remark-highlight\"}),mdx(\"pre\",e({parentName:\"div\"},{className:\"language-typescript\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-typescript\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// index.ts\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" TasksStateModule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'./tasks-state.module'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// consumers can interact and retrieve the state using the Facade\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" TasksFacadeService \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'./services/tasks-facade.service'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" MockTasksFacadeService \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'./services/mock-tasks-facade.service'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n`))),mdx(\"h3\",null,\"Principle 3: Libraries should change for one reason and one only\"),mdx(\"p\",null,\"We can apply the Single Responsibility Principle to Nx libraries: if a library changes for multiple reasons, then it could (should?) be split.\"),mdx(\"p\",null,\"This is nothing new, and it's well-described in \",mdx(\"em\",{parentName:\"p\"},\"Clean Architecture\"),\" by Uncle Bob. With that said - it's also really hard to do well in practical terms.\"),mdx(\"p\",null,'What exactly is a single \"reason\"? This is a pretty tricky question you should answer when architecting a library.'),mdx(\"p\",null,\"What does your library do?\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Does it define the logic of a particular domain of your application(s)?\"),mdx(\"li\",{parentName:\"ul\"},\"Does it define a set of reusable UI components?\"),mdx(\"li\",{parentName:\"ul\"},\"Does it define a set of specific components related to the business domain?\")),mdx(\"p\",null,`If there is an \"and\" somewhere in your answer, then it's an indicator that you should separate the functionalities into another library.`),mdx(\"h3\",null,\"Final Words\"),mdx(\"p\",null,\"Nx is relatively new, and while I've seen many projects which approached it pretty well, I still have not seen one that I was entirely satisfied with.\"),mdx(\"p\",null,\"I have personally made loads of mistakes with it - it's really not as easy as it seems to lay down a perfect architecture for complex applications.\"),mdx(\"p\",null,\"As this is still something I'm trying to completely figure out, I cannot 100% recommend you follow it. If you enjoyed it, please do shoot me an email and let me know what you think of it.\"),mdx(\"hr\",null),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"If you enjoyed this article, follow me on \",mdx(\"a\",e({parentName:\"em\"},{href:\"https://twitter.com/gc_psk\"}),\"Twitter\"))))}MDXContent.isMDXComponent=!0;\n","scope":{}},"series":[],"morePosts":[],"moreArticles":[{"live":true,"readingTime":"2 min read","title":"Benchmarking Angular 12 with Webpack 5","date":"2021-05-14T00:00:00.322Z","slug":"webpack-5-angular12","coverImage":"/assets/images/posts/benchmarking-webpack-5.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Angular 12 has been released and with it the much awaited Webpack 5 upgrade. In this post I benchmarked the bundle-size and compilation speed against the previous version","tags":["angular"]},{"live":true,"readingTime":"3 min read","title":"Where to put your Angular models?","date":"2020-08-03T00:00:00.322Z","slug":"angular-where-to-put-models","ogImage":{"url":"/assets/images/posts/where-put-angular-models.png"},"coverImage":"/assets/images/posts/where-put-angular-models.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Organizing entities and models in your Angular app may be hard. This article explains where to put your entities and what mistakes to watch out for","tags":["angular","architecture"]},{"live":true,"readingTime":"5 min read","title":"Using the Intersection Observer API with Angular","date":"2020-08-01T00:00:00.322Z","slug":"intersection-observer-with-angular","coverImage":"/assets/images/posts/intersection-observer.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"This article shows how to build a directive with Angular that uses the Intersection Observer API to check when an element becomes visible on the page","tags":["angular","performance"]},{"live":true,"readingTime":"3 min read","title":"Setters vs ngOnChanges: which one is better?","date":"2020-07-30T00:00:00.322Z","slug":"setters-vs-ng-on-changes","coverImage":"/assets/images/posts/setters-vs-on-changes.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Listening to Input changes can be done in different ways. But which one should you use?","tags":["angular"]},{"live":true,"readingTime":"3 min read","title":"Async Rendering with a single Rx Operator","date":"2020-07-11T00:00:00.322Z","slug":"async-rendering-with-a-single-rx-operator","coverImage":"/assets/images/posts/async-rendering.webp","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"Increase your app rendering performance with this simple Rx operator","tags":["angular","rxjs"]},{"live":true,"readingTime":"6 min read","title":"3 Ways to Render Large Lists in Angular","date":"2020-05-09T00:00:00.322Z","slug":"three-ways-render-large-lists-angular","coverImage":"https://cdn-images-1.medium.com/max/2560/1*URBd9pgYJGC0vhqthQ-z8g.jpeg","collection":{"name":"Angular","primaryColor":"#e23236","primaryColorLight":"#dd00316e","contrastColor":"#ffffff","logo":"/assets/images/collections/angular.webp"},"excerpt":"An overview of the available techniques to render large lists of items with Angular","tags":["angular","performance"]}],"type":1},"__N_SSG":true},"page":"/[collection]/[slug]","query":{"collection":"angular","slug":"how-to-organize-nx-modules-with-angular"},"buildId":"LMv2Q51Igj6ta-9H8i7xA","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script async="" defer="" src="https://www.googletagmanager.com/gtag/js"></script><script id="gtmDataLayer">
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-172483071-1');
</script></body></html>